const Ro="modulepreload",zo=function(t){return"/extensions/ComfyUI-Mape-Helpers/tweak/"+t},ii={},kt=function(e,n,i){let o=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link");o=Promise.all(n.map(r=>{if(r=zo(r),r in ii)return;ii[r]=!0;const l=r.endsWith(".css"),a=l?'[rel="stylesheet"]':"";if(!!i)for(let g=s.length-1;g>=0;g--){const p=s[g];if(p.href===r&&(!l||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${a}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":Ro,l||(c.as="script",c.crossOrigin=""),c.href=r,document.head.appendChild(c),l)return new Promise((g,p)=>{c.addEventListener("load",g),c.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${r}`)))})}))}return o.then(()=>e()).catch(s=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=s,window.dispatchEvent(r),!r.defaultPrevented)throw s})},Do=(t,e)=>t===e,Ye=Symbol("solid-proxy"),In=Symbol("solid-track"),Yt={equals:Do};let Mi=Di;const Ue=1,Xt=2,Hi={owned:null,cleanups:null,context:null,owner:null};var ne=null;let mn=null,Bo=null,ce=null,ve=null,Ie=null,ln=0;function Bt(t,e){const n=ce,i=ne,o=t.length===0,s=e===void 0?i:e,r=o?Hi:{owned:null,cleanups:null,context:s?s.context:null,owner:s},l=o?t:()=>t(()=>Le(()=>an(r)));ne=r,ce=null;try{return ft(l,!0)}finally{ce=n,ne=i}}function Z(t,e){e=e?Object.assign({},Yt,e):Yt;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},i=o=>(typeof o=="function"&&(o=o(n.value)),zi(n,o));return[Ri.bind(n),i]}function X(t,e,n){const i=Xn(t,e,!1,Ue);Ot(i)}function Se(t,e,n){Mi=Yo;const i=Xn(t,e,!1,Ue),o=oi&&Ko(oi);o&&(i.suspense=o),(!n||!n.render)&&(i.user=!0),Ie?Ie.push(i):Ot(i)}function oe(t,e,n){n=n?Object.assign({},Yt,n):Yt;const i=Xn(t,e,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=n.equals||void 0,Ot(i),Ri.bind(i)}function Uo(t){return ft(t,!1)}function Le(t){if(ce===null)return t();const e=ce;ce=null;try{return t()}finally{ce=e}}function st(t){Se(()=>Le(t))}function xt(t){return ne===null||(ne.cleanups===null?ne.cleanups=[t]:ne.cleanups.push(t)),t}function Tn(){return ce}function Fo(){return ne}function Ko(t){return ne&&ne.context&&ne.context[t.id]!==void 0?ne.context[t.id]:t.defaultValue}function Vo(t){const e=oe(t),n=oe(()=>Nn(e()));return n.toArray=()=>{const i=n();return Array.isArray(i)?i:i!=null?[i]:[]},n}let oi;function Ri(){if(this.sources&&this.state)if(this.state===Ue)Ot(this);else{const t=ve;ve=null,ft(()=>qt(this),!1),ve=t}if(ce){const t=this.observers?this.observers.length:0;ce.sources?(ce.sources.push(this),ce.sourceSlots.push(t)):(ce.sources=[this],ce.sourceSlots=[t]),this.observers?(this.observers.push(ce),this.observerSlots.push(ce.sources.length-1)):(this.observers=[ce],this.observerSlots=[ce.sources.length-1])}return this.value}function zi(t,e,n){let i=t.value;return(!t.comparator||!t.comparator(i,e))&&(t.value=e,t.observers&&t.observers.length&&ft(()=>{for(let o=0;o<t.observers.length;o+=1){const s=t.observers[o],r=mn&&mn.running;r&&mn.disposed.has(s),(r?!s.tState:!s.state)&&(s.pure?ve.push(s):Ie.push(s),s.observers&&Bi(s)),r||(s.state=Ue)}if(ve.length>1e6)throw ve=[],new Error},!1)),e}function Ot(t){if(!t.fn)return;an(t);const e=ln;Wo(t,t.value,e)}function Wo(t,e,n){let i;const o=ne,s=ce;ce=ne=t;try{i=t.fn(e)}catch(r){return t.pure&&(t.state=Ue,t.owned&&t.owned.forEach(an),t.owned=null),t.updatedAt=n+1,Ui(r)}finally{ce=s,ne=o}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?zi(t,i):t.value=i,t.updatedAt=n)}function Xn(t,e,n,i=Ue,o){const s={fn:t,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:ne,context:ne?ne.context:null,pure:n};return ne===null||ne!==Hi&&(ne.owned?ne.owned.push(s):ne.owned=[s]),s}function Jt(t){if(t.state===0)return;if(t.state===Xt)return qt(t);if(t.suspense&&Le(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<ln);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===Ue)Ot(t);else if(t.state===Xt){const i=ve;ve=null,ft(()=>qt(t,e[0]),!1),ve=i}}function ft(t,e){if(ve)return t();let n=!1;e||(ve=[]),Ie?n=!0:Ie=[],ln++;try{const i=t();return Go(n),i}catch(i){n||(Ie=null),ve=null,Ui(i)}}function Go(t){if(ve&&(Di(ve),ve=null),t)return;const e=Ie;Ie=null,e.length&&ft(()=>Mi(e),!1)}function Di(t){for(let e=0;e<t.length;e++)Jt(t[e])}function Yo(t){let e,n=0;for(e=0;e<t.length;e++){const i=t[e];i.user?t[n++]=i:Jt(i)}for(e=0;e<n;e++)Jt(t[e])}function qt(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const i=t.sources[n];if(i.sources){const o=i.state;o===Ue?i!==e&&(!i.updatedAt||i.updatedAt<ln)&&Jt(i):o===Xt&&qt(i,e)}}}function Bi(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=Xt,n.pure?ve.push(n):Ie.push(n),n.observers&&Bi(n))}}function an(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),i=t.sourceSlots.pop(),o=n.observers;if(o&&o.length){const s=o.pop(),r=n.observerSlots.pop();i<o.length&&(s.sourceSlots[r]=i,o[i]=s,n.observerSlots[i]=r)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)an(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Xo(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function Ui(t,e=ne){throw Xo(t)}function Nn(t){if(typeof t=="function"&&!t.length)return Nn(t());if(Array.isArray(t)){const e=[];for(let n=0;n<t.length;n++){const i=Nn(t[n]);Array.isArray(i)?e.push.apply(e,i):e.push(i)}return e}return t}const Jo=Symbol("fallback");function si(t){for(let e=0;e<t.length;e++)t[e]()}function qo(t,e,n={}){let i=[],o=[],s=[],r=0,l=e.length>1?[]:null;return xt(()=>si(s)),()=>{let a=t()||[],u,c;return a[In],Le(()=>{let p=a.length,d,f,h,y,_,A,b,x,j;if(p===0)r!==0&&(si(s),s=[],i=[],o=[],r=0,l&&(l=[])),n.fallback&&(i=[Jo],o[0]=Bt(I=>(s[0]=I,n.fallback())),r=1);else if(r===0){for(o=new Array(p),c=0;c<p;c++)i[c]=a[c],o[c]=Bt(g);r=p}else{for(h=new Array(p),y=new Array(p),l&&(_=new Array(p)),A=0,b=Math.min(r,p);A<b&&i[A]===a[A];A++);for(b=r-1,x=p-1;b>=A&&x>=A&&i[b]===a[x];b--,x--)h[x]=o[b],y[x]=s[b],l&&(_[x]=l[b]);for(d=new Map,f=new Array(x+1),c=x;c>=A;c--)j=a[c],u=d.get(j),f[c]=u===void 0?-1:u,d.set(j,c);for(u=A;u<=b;u++)j=i[u],c=d.get(j),c!==void 0&&c!==-1?(h[c]=o[u],y[c]=s[u],l&&(_[c]=l[u]),c=f[c],d.set(j,c)):s[u]();for(c=A;c<p;c++)c in h?(o[c]=h[c],s[c]=y[c],l&&(l[c]=_[c],l[c](c))):o[c]=Bt(g);o=o.slice(0,r=p),i=a.slice(0)}return o});function g(p){if(s[c]=p,l){const[d,f]=Z(c);return l[c]=f,e(a[c],d)}return e(a[c])}}}let Zo=!1;function fe(t,e){return Le(()=>t(e||{}))}const Qo=t=>`Stale read from <${t}>.`;function Fi(t){const e="fallback"in t&&{fallback:()=>t.fallback};return oe(qo(()=>t.each,t.children,e||void 0))}function Ki(t){let e=!1;const n=(s,r)=>(e?s[1]===r[1]:!s[1]==!r[1])&&s[2]===r[2],i=Vo(()=>t.children),o=oe(()=>{let s=i();Array.isArray(s)||(s=[s]);for(let r=0;r<s.length;r++){const l=s[r].when;if(l)return e=!!s[r].keyed,[r,l,s[r]]}return[-1]},void 0,{equals:n});return oe(()=>{const[s,r,l]=o();if(s<0)return t.fallback;const a=l.children;return typeof a=="function"&&a.length>0?Le(()=>a(e?r:()=>{if(Le(o)[0]!==s)throw Qo("Match");return l.when})):a},void 0,void 0)}function We(t){return t}function es(t,e,n){let i=n.length,o=e.length,s=i,r=0,l=0,a=e[o-1].nextSibling,u=null;for(;r<o||l<s;){if(e[r]===n[l]){r++,l++;continue}for(;e[o-1]===n[s-1];)o--,s--;if(o===r){const c=s<i?l?n[l-1].nextSibling:n[s-l]:a;for(;l<s;)t.insertBefore(n[l++],c)}else if(s===l)for(;r<o;)(!u||!u.has(e[r]))&&e[r].remove(),r++;else if(e[r]===n[s-1]&&n[l]===e[o-1]){const c=e[--o].nextSibling;t.insertBefore(n[l++],e[r++].nextSibling),t.insertBefore(n[--s],c),e[o]=n[s]}else{if(!u){u=new Map;let g=l;for(;g<s;)u.set(n[g],g++)}const c=u.get(e[r]);if(c!=null)if(l<c&&c<s){let g=r,p=1,d;for(;++g<o&&g<s&&!((d=u.get(e[g]))==null||d!==c+p);)p++;if(p>c-l){const f=e[r];for(;l<c;)t.insertBefore(n[l++],f)}else t.replaceChild(n[l++],e[r++])}else r++;else e[r++].remove()}}}const ri="_$DX_DELEGATE";function Vi(t,e,n,i={}){let o;return Bt(s=>{o=s,e===document?t():K(e,t(),e.firstChild?null:void 0,n)},i.owner),()=>{o(),e.textContent=""}}function Y(t,e,n){let i;const o=()=>{const r=document.createElement("template");return r.innerHTML=t,n?r.content.firstChild.firstChild:r.content.firstChild},s=e?()=>Le(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function Ze(t,e=window.document){const n=e[ri]||(e[ri]=new Set);for(let i=0,o=t.length;i<o;i++){const s=t[i];n.has(s)||(n.add(s),e.addEventListener(s,ns))}}function pe(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}function ts(t,e){e==null?t.removeAttribute("class"):t.className=e}function Jn(t,e,n,i){if(i)Array.isArray(n)?(t[`$$${e}`]=n[0],t[`$$${e}Data`]=n[1]):t[`$$${e}`]=n;else if(Array.isArray(n)){const o=n[0];t.addEventListener(e,n[0]=s=>o.call(t,n[1],s))}else t.addEventListener(e,n)}function _t(t,e,n){return Le(()=>t(e,n))}function K(t,e,n,i){if(n!==void 0&&!i&&(i=[]),typeof e!="function")return Zt(t,e,i,n);X(o=>Zt(t,e(),o,n),i)}function ns(t){const e=`$$${t.type}`;let n=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==n&&Object.defineProperty(t,"target",{configurable:!0,value:n}),Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return n||document}});n;){const i=n[e];if(i&&!n.disabled){const o=n[`${e}Data`];if(o!==void 0?i.call(n,o,t):i.call(n,t),t.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function Zt(t,e,n,i,o){for(;typeof n=="function";)n=n();if(e===n)return n;const s=typeof e,r=i!==void 0;if(t=r&&n[0]&&n[0].parentNode||t,s==="string"||s==="number")if(s==="number"&&(e=e.toString()),r){let l=n[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),n=et(t,n,i,l)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e;else if(e==null||s==="boolean")n=et(t,n,i);else{if(s==="function")return X(()=>{let l=e();for(;typeof l=="function";)l=l();n=Zt(t,l,n,i)}),()=>n;if(Array.isArray(e)){const l=[],a=n&&Array.isArray(n);if(Ln(l,e,n,o))return X(()=>n=Zt(t,l,n,i,!0)),()=>n;if(l.length===0){if(n=et(t,n,i),r)return n}else a?n.length===0?li(t,l,i):es(t,n,l):(n&&et(t),li(t,l));n=l}else if(e.nodeType){if(Array.isArray(n)){if(r)return n=et(t,n,i,e);et(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function Ln(t,e,n,i){let o=!1;for(let s=0,r=e.length;s<r;s++){let l=e[s],a=n&&n[s],u;if(!(l==null||l===!0||l===!1))if((u=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))o=Ln(t,l,a)||o;else if(u==="function")if(i){for(;typeof l=="function";)l=l();o=Ln(t,Array.isArray(l)?l:[l],Array.isArray(a)?a:[a])||o}else t.push(l),o=!0;else{const c=String(l);a&&a.nodeType===3&&a.data===c?t.push(a):t.push(document.createTextNode(c))}}return o}function li(t,e,n=null){for(let i=0,o=e.length;i<o;i++)t.insertBefore(e[i],n)}function et(t,e,n,i){if(n===void 0)return t.textContent="";const o=i||document.createTextNode("");if(e.length){let s=!1;for(let r=e.length-1;r>=0;r--){const l=e[r];if(o!==l){const a=l.parentNode===t;!s&&!r?a?t.replaceChild(o,l):t.insertBefore(o,n):a&&l.remove()}else s=!0}}else t.insertBefore(o,n);return[o]}const is=async()=>{const{ImagePreviews:t}=await kt(()=>Promise.resolve().then(()=>Ks),void 0),e=document.createElement("div");document.body.appendChild(e),Vi(()=>fe(t,{}),e)},os=async()=>{const{registerPlugin:t}=await kt(()=>Promise.resolve().then(()=>dr),void 0);t(),async function e(){if(typeof app>"u"){setTimeout(e);return}const{MapeTweak:n}=await kt(()=>Promise.resolve().then(()=>El),void 0),i=document.createElement("div");document.body.appendChild(i),Vi(()=>fe(n,{}),i)}()};window.standaloneImagePreview?is():os();const ai=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ci="eexxaacctt",ui=(t,e)=>e==0?"":e==1?`${t}??`:e==1/0?`${t}*?`:`${t}{0,${e}}?`;function ss(){const t={interSplit:"[^A-Za-z\\d']+",intraSplit:"[a-z][A-Z]",intraBound:"[A-Za-z]\\d|\\d[A-Za-z]|[a-z][A-Z]",interChars:".",interIns:1/0,intraChars:"[a-z\\d']",intraIns:0,intraContr:"'[a-z]{1,2}\\b"},{intraIns:e,intraContr:n,intraSplit:i,interSplit:o,intraBound:s,intraChars:r}=t,l='".+?"',a=new RegExp(l,"gi"),u=new RegExp(`(?:\\s+|^)-(?:${r}+|${l})`,"gi"),c=!!i,g=new RegExp(i,"g"),p=new RegExp(o,"g"),d=new RegExp(`^${o}|${o}$`,"g"),f=new RegExp(n,"gi"),h=b=>{const x=[];b=b.replace(a,I=>(x.push(I),ci)),b=b.replace(d,"").toLocaleLowerCase(),c&&(b=b.replace(g,I=>`${I[0]} ${I[1]}`));let j=0;return b.split(p).filter(I=>I!="").map(I=>I===ci?x[j++]:I)},y=b=>{let x=h(b);if(x.length==0)return[void 0];const j=Array(x.length).fill("");x=x.map((F,S)=>F.replace(f,$=>(j[S]=$,"")));const I=ui(r,e);let B=x.map((F,S)=>F[0]==='"'?ai(F.slice(1,-1)):F.split("").join(I)+j[S]);const M=ui(t.interChars,t.interIns);return B=B.join(M),[new RegExp(B,"i")]},_=(b,x,j)=>{const[I]=y(x);if(!I)return[];const B=[];if(j!=null)for(let M=0;M<j.length;M++){const F=j[M];I.test(b[F])&&B.push(F)}else for(let M=0;M<b.length;M++)I.test(b[M])&&B.push(M.toString());return B};return(b,x)=>{let j,B=null,M=[];x=x.replace(u,S=>{let $=S.trim().slice(1);return $[0]==='"'&&($=ai($.slice(1,-1))),""});const F=h(x);if(F.length==0)return[];if(F.length>1){const S=F.slice().sort((N,H)=>H.length-N.length);for(let N=0;N<S.length;N++){if((j==null?void 0:j.length)==0)return[];j=_(b,S[N],j)}if(F.length>2)return j;B=rs(F).map(N=>N.join(" ")),M.length=0;const $=new Set;for(let N=0;N<B.length;N++)if($.size<(j==null?void 0:j.length)){const H=j==null?void 0:j.filter(R=>!$.has(R)),E=_(b,B[N],H);for(let R=0;R<E.length;R++)$.add(E[R]);M.push(E)}else M.push([])}return B==null&&(B=[x],M=[(j==null?void 0:j.length)>0?j:_(b,x)]),M.flat()}}function rs(t){t=t.slice();const e=t.length,n=[t.slice()],i=new Array(e).fill(0);let o=1,s,r;for(;o<e;)i[o]<o?(s=o%2&&i[o],r=t[o],t[o]=t[s],t[s]=r,++i[o],o=1,n.push(t.slice())):(i[o]=0,++o);return n}const Mn=Symbol("store-raw"),rt=Symbol("store-node"),Pe=Symbol("store-has"),Wi=Symbol("store-self");function Gi(t){let e=t[Ye];if(!e&&(Object.defineProperty(t,Ye,{value:e=new Proxy(t,cs)}),!Array.isArray(t))){const n=Object.keys(t),i=Object.getOwnPropertyDescriptors(t);for(let o=0,s=n.length;o<s;o++){const r=n[o];i[r].get&&Object.defineProperty(t,r,{enumerable:i[r].enumerable,get:i[r].get.bind(e)})}}return e}function Be(t){let e;return t!=null&&typeof t=="object"&&(t[Ye]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function ct(t,e=new Set){let n,i,o,s;if(n=t!=null&&t[Mn])return n;if(!Be(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let r=0,l=t.length;r<l;r++)o=t[r],(i=ct(o,e))!==o&&(t[r]=i)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const r=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let a=0,u=r.length;a<u;a++)s=r[a],!l[s].get&&(o=t[s],(i=ct(o,e))!==o&&(t[s]=i))}return t}function Qt(t,e){let n=t[e];return n||Object.defineProperty(t,e,{value:n=Object.create(null)}),n}function St(t,e,n){if(t[e])return t[e];const[i,o]=Z(n,{equals:!1,internal:!0});return i.$=o,t[e]=i}function ls(t,e){const n=Reflect.getOwnPropertyDescriptor(t,e);return!n||n.get||!n.configurable||e===Ye||e===rt||(delete n.value,delete n.writable,n.get=()=>t[Ye][e]),n}function Yi(t){Tn()&&St(Qt(t,rt),Wi)()}function as(t){return Yi(t),Reflect.ownKeys(t)}const cs={get(t,e,n){if(e===Mn)return t;if(e===Ye)return n;if(e===In)return Yi(t),n;const i=Qt(t,rt),o=i[e];let s=o?o():t[e];if(e===rt||e===Pe||e==="__proto__")return s;if(!o){const r=Object.getOwnPropertyDescriptor(t,e);Tn()&&(typeof s!="function"||t.hasOwnProperty(e))&&!(r&&r.get)&&(s=St(i,e,s)())}return Be(s)?Gi(s):s},has(t,e){return e===Mn||e===Ye||e===In||e===rt||e===Pe||e==="__proto__"?!0:(Tn()&&St(Qt(t,Pe),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:as,getOwnPropertyDescriptor:ls};function ke(t,e,n,i=!1){if(!i&&t[e]===n)return;const o=t[e],s=t.length;n===void 0?(delete t[e],t[Pe]&&t[Pe][e]&&o!==void 0&&t[Pe][e].$()):(t[e]=n,t[Pe]&&t[Pe][e]&&o===void 0&&t[Pe][e].$());let r=Qt(t,rt),l;if((l=St(r,e,o))&&l.$(()=>n),Array.isArray(t)&&t.length!==s){for(let a=t.length;a<s;a++)(l=r[a])&&l.$();(l=St(r,"length",s))&&l.$(t.length)}(l=r[Wi])&&l.$()}function Xi(t,e){const n=Object.keys(e);for(let i=0;i<n.length;i+=1){const o=n[i];ke(t,o,e[o])}}function us(t,e){if(typeof e=="function"&&(e=e(t)),e=ct(e),Array.isArray(e)){if(t===e)return;let n=0,i=e.length;for(;n<i;n++){const o=e[n];t[n]!==o&&ke(t,n,o)}ke(t,"length",i)}else Xi(t,e)}function yt(t,e,n=[]){let i,o=t;if(e.length>1){i=e.shift();const r=typeof i,l=Array.isArray(t);if(Array.isArray(i)){for(let a=0;a<i.length;a++)yt(t,[i[a]].concat(e),n);return}else if(l&&r==="function"){for(let a=0;a<t.length;a++)i(t[a],a)&&yt(t,[a].concat(e),n);return}else if(l&&r==="object"){const{from:a=0,to:u=t.length-1,by:c=1}=i;for(let g=a;g<=u;g+=c)yt(t,[g].concat(e),n);return}else if(e.length>1){yt(t[i],e,[i].concat(n));return}o=t[i],n=[i].concat(n)}let s=e[0];typeof s=="function"&&(s=s(o,n),s===o)||i===void 0&&s==null||(s=ct(s),i===void 0||Be(o)&&Be(s)&&!Array.isArray(s)?Xi(o,s):ke(t,i,s))}function en(...[t,e]){const n=ct(t||{}),i=Array.isArray(n),o=Gi(n);function s(...r){Uo(()=>{i&&r.length===1?us(n,r[0]):yt(n,r)})}return[o,s]}const Hn=Symbol("store-root");function tt(t,e,n,i,o){const s=e[n];if(t===s)return;const r=Array.isArray(t);if(n!==Hn&&(!Be(t)||!Be(s)||r!==Array.isArray(s)||o&&t[o]!==s[o])){ke(e,n,t);return}if(r){if(t.length&&s.length&&(!i||o&&t[0]&&t[0][o]!=null)){let u,c,g,p,d,f,h,y;for(g=0,p=Math.min(s.length,t.length);g<p&&(s[g]===t[g]||o&&s[g]&&t[g]&&s[g][o]===t[g][o]);g++)tt(t[g],s,g,i,o);const _=new Array(t.length),A=new Map;for(p=s.length-1,d=t.length-1;p>=g&&d>=g&&(s[p]===t[d]||o&&s[g]&&t[g]&&s[p][o]===t[d][o]);p--,d--)_[d]=s[p];if(g>d||g>p){for(c=g;c<=d;c++)ke(s,c,t[c]);for(;c<t.length;c++)ke(s,c,_[c]),tt(t[c],s,c,i,o);s.length>t.length&&ke(s,"length",t.length);return}for(h=new Array(d+1),c=d;c>=g;c--)f=t[c],y=o&&f?f[o]:f,u=A.get(y),h[c]=u===void 0?-1:u,A.set(y,c);for(u=g;u<=p;u++)f=s[u],y=o&&f?f[o]:f,c=A.get(y),c!==void 0&&c!==-1&&(_[c]=s[u],c=h[c],A.set(y,c));for(c=g;c<t.length;c++)c in _?(ke(s,c,_[c]),tt(t[c],s,c,i,o)):ke(s,c,t[c])}else for(let u=0,c=t.length;u<c;u++)tt(t[u],s,u,i,o);s.length>t.length&&ke(s,"length",t.length);return}const l=Object.keys(t);for(let u=0,c=l.length;u<c;u++)tt(t[l[u]],s,l[u],i,o);const a=Object.keys(s);for(let u=0,c=a.length;u<c;u++)t[a[u]]===void 0&&ke(s,a[u],void 0)}function Rn(t,e={}){const{merge:n,key:i="id"}=e,o=ct(t);return s=>{if(!Be(s)||!Be(o))return o;const r=tt(o,{[Hn]:s},Hn,n,i);return r===void 0?s:r}}var ds=Y("<div class=settingsPopup><div class=close>‚ùå</div><div class=header>Settings</div><div class=modalContent><div class=mapeSettings>"),fs=Y("<input type=text>"),hs=Y("<input type=color>"),ps=Y("<input type=number>"),gs=Y("<input type=checkbox>"),ms=Y('<div class=mapeSetting><label class=name></label><div class=reset title="Reset to default value">‚ôªÔ∏è</div><label class=value>');const Ji={nodeAlignOffsetY:{name:"Offset Y pixel amount",value:{type:"number",value:50}},nodeOrganizeSpacingInputY:{name:"Node organize input Y spacing",value:{type:"number",value:15}},nodeOrganizeSpacingOutputY:{name:"Node organize output Y spacing",value:{type:"number",value:34}},nodeOrganizeSpacingInputX:{name:"Node organize input X spacing",value:{type:"number",value:200}},nodeOrganizeSpacingOutputX:{name:"Node organize output X spacing",value:{type:"number",value:60}},alwaysPromptVariableName:{name:"Prompt for variable name",value:{type:"bool",value:!1}},collapseNodesOnOrganize:{name:"Collapse GET/SET when organizing node",value:{type:"bool",value:!0}},resizeNodeWidthOnAlignment:{name:"Resize node on left alignment",value:{type:"bool",value:!0}},showAllConnectionsOnFocus:{name:"Show connections for all nodes when focusing variable",value:{type:"bool",value:!0}},organizeSideNodes:{name:"Organize variables when dragging/selecting parent node",value:{type:"bool",value:!0}},replaceSearch:{name:"Hijack Comfy node search to allow fuzzy search (Might break)",value:{type:"bool",value:!0}},showConnectionOnNodeHover:{name:"Show connections when hovering a node",value:{type:"bool",value:!1}},showAllConnectionsOnNodeHover:{name:"Show all connections when hovering a node",value:{type:"bool",value:!1}},animateSelectedNode:{name:"Animate connections of the selected node",value:{type:"bool",value:!1}},animateAllNodes:{name:"Animate connections of all nodes",value:{type:"bool",value:!1}},selectedNodeConnectionOpacity:{name:"Opacity % of selected node connections",value:{type:"number",value:100}},nodeConnectionOpacity:{name:"Opacity % of node connections",value:{type:"number",value:10}},dblClickToRename:{name:"Double click regular node to set title",value:{type:"bool",value:!0}},setIcon:{name:"Set title icon",value:{type:"string",value:"üíæ "}},setBackgroundColor:{name:"Set title background color",value:{type:"color",value:"#212121"}},getIcon:{name:"Get title icon",value:{type:"string",value:""}},getBackgroundColor:{name:"Get title background",value:{type:"color",value:"#212121"}},dblClickToRenameGroup:{name:"Double click groups to set title",value:{type:"bool",value:!0}},profileNodes:{name:"Show node runtime duration",value:{type:"bool",value:!0}}},[Ut,nt]=en(JSON.parse(JSON.stringify(Ji))),di=localStorage.mape_helpers_settings;if(di)try{const t=JSON.parse(di);for(const[e,n]of Object.entries(t))nt(e,"value","value",n)}catch{console.error("Failed to parse settings")}const ee=t=>Ut[t].value.value,vs=t=>{const e=()=>{localStorage.mape_helpers_settings=JSON.stringify(Object.fromEntries(Object.entries(Ut).map(([n,i])=>[n,i.value.value])))};return Se(()=>{JSON.stringify(Ut),e()}),(()=>{var n=ds(),i=n.firstChild,o=i.nextSibling,s=o.nextSibling,r=s.firstChild;return Jn(i,"click",t.close,!0),K(r,()=>Object.entries(Ut).map(([l,{name:a,value:u}])=>(()=>{var c=ms(),g=c.firstChild,p=g.nextSibling,d=p.nextSibling;return pe(g,"for",l),K(g,a),p.$$click=()=>{nt(l,"value","value",Ji[l].value.value)},K(d,fe(Ki,{get children(){return[fe(We,{get when(){return u.type==="string"},get children(){var f=fs();return f.$$input=h=>{nt(l,"value","value",h.currentTarget.value)},pe(f,"id",l),X(()=>f.value=u.value),f}}),fe(We,{get when(){return u.type==="color"},get children(){var f=hs();return f.$$input=h=>{nt(l,"value","value",h.currentTarget.value)},pe(f,"id",l),X(()=>f.value=u.value),f}}),fe(We,{get when(){return u.type==="number"},get children(){var f=ps();return f.$$input=h=>{nt(l,"value","value",parseFloat(h.currentTarget.value))},pe(f,"id",l),X(()=>f.value=u.value),f}}),fe(We,{get when(){return u.type==="bool"},get children(){var f=gs();return f.addEventListener("change",h=>{nt(l,"value","value",h.currentTarget.checked)}),pe(f,"id",l),X(()=>f.checked=u.value),f}})]}})),c})())),n})()};Ze(["click","input"]);const Ht="mape_tweak_",ys="mape_imagepreview_";function _s(t,e){let n=e;for(;n!==null;){if(n===t)return!0;n=n.parentElement}return!1}const vn=()=>{const t=document.activeElement;return t.tagName==="INPUT"&&(t.type==="text"||t.type==="number")||t.tagName==="TEXTAREA"},bs=t=>{const e=document.createElement("style");return e.appendChild(document.createTextNode(t)),e},Re=t=>t?`/view?filename=${t.filename}&subfolder=${t.subfolder}&type=${t.type}&rand=42`:void 0,$s=(t,e,n=.35)=>{let i=1,o=1,s=1,r=1,l=1,a=1,u=1;const c=t[0],g=t[1],p=g/c;for(let d=1;d<=e;d++){const f=d,h=Math.ceil(e/f);h/f*n>p?(u=Math.floor(g/h),a=Math.floor(u/n)):(a=Math.floor(c/f),u=Math.floor(a*n));const y=a*u*e;(i===void 0||y>i)&&(i=y,r=u,l=a,o=f,s=h)}return{targetCols:o,targetRows:s,targetHeight:r,targetWidth:l}},zn=(t,e,n,i)=>{const o=n-t,s=i-e;return Math.sqrt(o**2+s**2)},qi=t=>{const e=Object.fromEntries(Object.values(t).map(s=>[s.name,s.pos??[0,0]])),n=Math.min(...Object.values(e).map(([s,r])=>s)),i=Math.min(...Object.values(e).map(([s,r])=>r)),o=Object.fromEntries(Object.entries(e).map(([s,[r,l]])=>[s,zn(n,i,r,l)]));return(s,r)=>o[s.name]-o[r.name]},_e=t=>{var e,n;return he(t)&&((n=(e=t.inputs)==null?void 0:e[0])==null?void 0:n.link)},lt=t=>{var e,n,i;return he(t)&&((i=(n=(e=t.outputs)==null?void 0:e[0])==null?void 0:n.links)==null?void 0:i.length)};function he(t){let e=t.type;return t.IS_MAPE_VARIABLE?!0:(e===void 0&&(e=t.comfyClass),e?e.startsWith(Te):!1)}const Te="mape Variable",fi="*",q=(t,e=0)=>{var n;if(t){if(t.widgets&&t.widgets[e])return t.widgets[e].value;if(t.widgets_values)return(n=t.widgets_values)==null?void 0:n[e]}},be=(t,e,n=0)=>{t.widgets_values||(t.widgets_values=[]),t.widgets_values[n]=e,t.widgets[n].value=e},ws=(t,e)=>{const n=ze().filter(he);return(e==="get"?n.filter(lt):n.filter(_e)).filter(o=>q(o)===t)},xe=t=>graph.getNodeById(t),ze=()=>graph._nodes,Zi=()=>ze().filter(he),ks=()=>Zi().filter(_e),Qi=()=>graph._groups,xs=()=>Object.values(graph.list_of_graphcanvas[0].selected_nodes)[0],pt=t=>{for(const e of ze())e.type!==Te||!_e(e)||q(e)!==t||at(e)},at=t=>{var r;const e=(r=t.graph)==null?void 0:r.list_of_graphcanvas[0],[n,i]=t.pos,[o,s]=t.size;eo([n+o/2,i+s/2],e),e==null||e.selectNode(t)},hi=t=>{const e=graph.getNodeById(t);e&&at(e)},Ss=t=>{const e=Qi().find(n=>n.title===t);e&&eo([e.pos[0]+e.size[0]/2,e.pos[1]+e.size[1]/2],graph.list_of_graphcanvas[0])},pi=(t,e=!1)=>{var r,l,a;if(t.length===0)return;const n=ee("nodeOrganizeSpacingInputX"),i=ee("nodeOrganizeSpacingOutputX");for(const u of t){let c=0,g=0;const p=ee("nodeOrganizeSpacingInputY"),d=ee("nodeOrganizeSpacingOutputY"),f=[];if(u.graph){for(const h of u.inputs??[]){const y=h.link;if(!y)continue;const{origin_id:_,target_slot:A}=u.graph.links[y],b=xe(_);if(!b||b.type!==Te)continue;if(b.outputs&&b.outputs[0]&&b.outputs[0].links&&b.outputs[0].links.length>1)return;const x=u.getConnectionPos(!0,A);b.pos=[x[0]-n,x[1]+15+c*p],c+=1,f.push(b),b.flags.collapsed=ee("collapseNodesOnOrganize")}for(const h of u.outputs??[])if(h.links&&u.graph)for(const y of h.links){const{target_id:_}=u.graph.links[y],A=xe(_);if(!A){console.error("Failed",u.id,">",_);continue}if(A.type!==Te)continue;const b=(l=(r=A.outputs)==null?void 0:r[0])==null?void 0:l.links;if(b&&b.length>1)return;const x=u.getConnectionPos(!1,0);A.pos=[x[0]+i,x[1]+15+g*d],g+=1,f.push(A),A.flags.collapsed=ee("collapseNodesOnOrganize")}if(e&&t.length===1){const h=[u,...f];u.graph.list_of_graphcanvas[0].selectNodes(h)}}}const o=t[0];if(!o)return;((a=o.graph)==null?void 0:a.list_of_graphcanvas[0]).setDirty(!0,!0),He()},eo=([t,e],n)=>{const i=n.ds,o=document.body.clientWidth,s=document.body.clientHeight,r=i.scale,l=-t+o*.5/r,a=-e+s*.5/r,u=250,c=Date.now()+u,g=i.offset[0],p=i.offset[1],d=()=>{const f=c-Date.now();if(Date.now()<c)requestAnimationFrame(d);else{i.offset[0]=l,i.offset[1]=a,n.setDirty(!0,!0);return}const h=1-f/u;i.offset[0]=gi(g,l,h),i.offset[1]=gi(p,a,h),n.setDirty(!0,!0)};requestAnimationFrame(d)};function As(t){return .5-.5*Math.cos(Math.PI*t)}function gi(t,e,n){return n=As(n),t+n*(e-t)}const He=(()=>{let t;return()=>{clearTimeout(t),t=setTimeout(to,50)}})(),to=()=>{window.dispatchEvent(new CustomEvent("mapeTweak",{detail:{message:"valueUpdated"}}))},Rt=t=>t.toLowerCase().replace(/_./g,e=>e.replace("_","").toUpperCase()),Es=t=>t?t.mode===0?!0:t.mode!==2:!1,Cs=t=>{const e=q(t);return ks().find(n=>q(n)===e)},zt=(t,e)=>{var s,r,l;const n=(s=app.canvas)==null?void 0:s.default_connection_color_byType,i=(r=t.inputs)==null?void 0:r[0],o=(l=t.outputs)==null?void 0:l[0];i&&(i.name=e,i.type=e,i.color_on=n[e]),o&&(o.name=e,o.type=e,o.color_on=n[e])},mi=t=>{const e=(n,i=!1,o=s=>{})=>{if(!t.graph)return;const s=Object.values(t.graph.links).filter(Boolean).find(l=>l.id===n);if(!s)return;if(i){const l=xe(s.origin_id);if(!l)return;const a=l.outputs[s.origin_slot].type.toString();zt(t,a),o(a);return}if(!s){zt(t,fi);return}const r=s.type;zt(t,r),o(r)};setTimeout(()=>{var n,i,o,s,r,l;if(_e(t)){const a=(i=(n=t.inputs)==null?void 0:n[0])==null?void 0:i.link;if(!a)return;e(a,!0,u=>{const c=q(t);localStorage[`mape_tweak_${c}`]&&(localStorage[`mape_tweak_${c}`]=u)})}else if(lt(t)){const a=(r=(s=(o=t.outputs)==null?void 0:o[0])==null?void 0:s.links)==null?void 0:r[0];a&&e(a)}else zt(t,fi);if(_e(t)){const a=q(t);(l=t.widgets)!=null&&l[1]||t.addWidget("toggle","tweak",!!localStorage[`mape_tweak_${a}`],u=>{var p,d;const c=(d=(p=t.inputs)==null?void 0:p[0])==null?void 0:d.type,g=q(t);u?localStorage[`mape_tweak_${g}`]=c:delete localStorage[`mape_tweak_${g}`],He()}),t.setProperty("tweak",!!localStorage[`mape_tweak_${a}`])}})},Me=(t,e)=>{var n,i,o,s;for(const r of graph._nodes){if(r.type!==Te||q(r)!==t||!r.inputs[0])continue;const l=(i=(n=r.inputs)==null?void 0:n[0])==null?void 0:i.link;if(l===null)continue;const a=(o=r.graph)==null?void 0:o.links[l];if(typeof a>"u")continue;const u=a.origin_id;if(typeof u>"u")continue;const c=a.origin_slot;if(typeof c>"u"||!r.graph)continue;const g=r.graph.getNodeById(u);if(typeof g>"u")continue;const p=(s=g.widgets)==null?void 0:s[c];typeof p>"u"||(p.options&&p.options.setValue?typeof e=="function"?p.options.setValue(e(p.value)):p.options.setValue(e):typeof e=="function"?p.value=e(p.value):p.value=e,app.graph.setDirtyCanvas(!0,!0),to())}},js=t=>{var o,s,r,l,a;let e,n,i;for(const u of graph._nodes){if(u.type!==Te||q(u)!==t||!u.graph)continue;const c=(s=(o=u.inputs)==null?void 0:o[0])==null?void 0:s.link;if(!c)continue;const g=u.graph.links[c];if(typeof g>"u")continue;const p=g.origin_id;if(typeof p>"u")continue;const d=g.origin_slot;if(typeof d>"u")continue;const f=u.graph.getNodeById(p);if(!f)continue;if(f.outputs[d]&&f.outputs[d].type==="IMAGE"){let y;for(const _ of graph._nodes){if(!he(_)||q(_)!==t||_e(_))continue;const A=(l=(r=_.outputs)==null?void 0:r[0].links)==null?void 0:l[0];if(typeof A>"u")continue;const b=u.graph.links[A];if(!b)continue;const x=b.target_id,j=u.graph.getNodeById(x);j&&(a=j.type)!=null&&a.match(/(PreviewImage|SaveImage)/)&&(y=j.images)}return n=f.id,e=y,i=u.id,[y,n,i]}if(typeof f>"u"||!f.widgets)continue;const h=f.widgets[d];typeof h>"u"||(n=f.id,i=u.id,e=h.value)}return[e,n,i]},Ps=t=>{var s,r,l;const e=(r=(s=t.inputs)==null?void 0:s[0])==null?void 0:r.link;if(!t.graph||!e)return;const n=(l=t.graph)==null?void 0:l.links[e];if(!n)return;const i=n.origin_id;return t.graph.getNodeById(i)};function Os(t){return t.filter((e,n,i)=>i.indexOf(e)===n)}const Is=ss();function Ts(t,e){return Is([e],t).length>0}function Ns(t,e){e&&(t.save(),t.fillStyle="#000",t.fillText(e,6,-LiteGraph.NODE_TITLE_HEIGHT-2+1),t.fillStyle="#fff",t.fillText(e,5,-LiteGraph.NODE_TITLE_HEIGHT-2),t.restore())}var Ls=Y("<div class=imagePreviews>"),Ms=Y("<div class=imagePreviewTweaks><label>Image Previews</label><label>Display type"),vi=Y("<img class=fullImage>"),Hs=Y("<div class=mosaicGrid><div class=inner>"),Rs=Y('<div class=flipbookFps><label for="">FPS</label><input type=number step=1 min=1 max=120><label for=flipflop title="Reverse at end of clip instead of restarting">Flip Flop</label><input id=flipflop type=checkbox>'),zs=Y("<div class=content><div class=bigPreview><div class=zoom>x"),yi=Y("<div class=button>"),Ds=Y("<div class=thumbnails>"),Bs=Y("<div class=thumb><img class=smallImage>"),Us=Y("<div class=mosaicImage><img class=smallImage>");const bt="mape_image_previews",yn=`${ys}FPS`,Fs=()=>{const[t,e]=Z(1),[n,i]=Z([0,0]),[o,s]=Z(0),[r,l]=Z("images"),[a,u]=Z({}),[c,g]=Z(localStorage.mapeImageDisplayType??"single");let p;Se(()=>{r(),f(0)});const[d,f]=Z(0),[h,y]=Z(localStorage[yn]?JSON.parse(localStorage[yn]):{}),[_,A]=Z(!!localStorage.mape_tweak_flipflop);Se(()=>{localStorage[yn]=JSON.stringify(h())}),Se(()=>{_()?localStorage.mape_tweak_flipflop=!0:delete localStorage.mape_tweak_flipflop});let b=1;const x=()=>{if(clearTimeout(p),c()==="flipbook"){if(p=setTimeout(x,1e3/(h()[r()]??12)),!I()||!I().value){f(0);return}const w=I().value.length;if(w===1){f(0);return}if(_()){const P=d()+b;(P<0||P>=w)&&(b=-b);const C=d()+b;f(C)}else{let P=d()+1;P>=w&&(P=0),f(P)}}};xt(()=>{clearTimeout(p)}),Se(()=>{localStorage.mapeImageDisplayType=c(),f(0),b=1,c()==="flipbook"&&(f(0),setTimeout(x))}),localStorage[bt]&&u(JSON.parse(localStorage[bt]));function j(w){const{key:P,newValue:C}=w;P===bt&&C&&(u(JSON.parse(C)),I()||l(Object.keys(a())[0]??""),I()&&I().value&&I().value.length<=o()&&s(0))}window.addEventListener("storage",j);const I=()=>a()[r()],B=()=>`scale(${v()}) translate(calc(-50% + ${n()[0]}px), calc(-50% + ${n()[1]}px))`;let M;const[F,S]=Z([100,100]);Se(()=>{c(),M&&S([M.clientWidth,M.clientHeight])}),window.addEventListener("resize",()=>{M&&S([M.clientWidth,M.clientHeight])});const[$,N]=Z(1),[H,E]=Z([1,1]);Se(()=>{const w=U()[0];if(!w)return;const P=Re(w),C=new Image;C.addEventListener("load",()=>{N(C.height/C.width),console.log($()),E([C.width,C.height])}),C.src=P});const R=()=>{console.log("getBestRatio",$());const w=$s(F(),U().length,$());console.log({pos:w});const P=w.targetHeight*w.targetRows,C=w.targetWidth*w.targetCols;return{imageWidth:Math.min(H()[0],w.targetWidth),imageHeight:Math.min(H()[1],w.targetHeight),containerHeight:P,containerWidth:C,ratio:Math.min(1,Math.max(w.targetWidth,w.targetHeight)/Math.max(...H()))}},V=(w=!1)=>{s(0),w&&(i([0,0]),e(1))},U=()=>(I()??{}).value??[],m=w=>Math.pow(w,2.5),v=()=>m(t());return(()=>{var w=Ls();return K(w,(()=>{var P=oe(()=>!!I());return()=>P()?[(()=>{var C=Ms(),O=C.firstChild,T=O.nextSibling;return K(C,()=>Object.values(a()).sort(qi(a())).map(L=>(()=>{var k=yi();return k.$$click=()=>{V(),s(0),l(L.name)},K(k,()=>L.name),X(()=>k.classList.toggle("active",L.name===r())),k})()),T),K(C,()=>[{id:"single",text:"Single image"},{id:"mosaic",text:"Grid view"},{id:"flipbook",text:"Flipbook"}].map(L=>(()=>{var k=yi();return k.$$click=()=>{V(),g(L.id)},K(k,()=>L.text),X(()=>k.classList.toggle("active",c()===L.id)),k})()),null),C})(),(()=>{var C=zs(),O=C.firstChild,T=O.firstChild,L=T.firstChild;return K(C,(()=>{var k=oe(()=>c()==="single"&&U().length>1);return()=>k()?(()=>{var W=Ds();return K(W,()=>U().map((z,G)=>(()=>{var D=Bs(),J=D.firstChild;return D.$$click=()=>{s(G)},X(Q=>{var ae=G===o(),ye=Re(z);return ae!==Q.e&&D.classList.toggle("active",Q.e=ae),ye!==Q.t&&pe(J,"src",Q.t=ye),Q},{e:void 0,t:void 0}),D})())),W})():null})(),O),O.addEventListener("wheel",k=>{const W=M.getClientRects()[0],[z,G]=[k.clientX,k.clientY],{x:D,y:J,width:Q,height:ae}=W,ye=(z-D)/Q,Ce=(G-J)/ae;e(Math.max(.1,t()-(k.deltaY>0?.075:-.075))),(()=>{i([0,0]);const Qe=M.getClientRects()[0],{x:gn,y:Oo,width:ti,height:ni}=Qe,Io=(z-gn)/ti,To=(G-Oo)/ni,No=Io-ye,Lo=To-Ce,Mo=No*ti/v(),Ho=Lo*ni/v();i([n()[0]+Mo,n()[1]+Ho])})()}),O.$$mousedown=k=>{const W=k.clientX,z=k.clientY,[G,D]=n(),J=ae=>{ae.preventDefault();const ye=ae.clientX,Ce=ae.clientY,Qe=W-ye,gn=z-Ce;i([G-Qe/v(),D-gn/v()])},Q=()=>{document.removeEventListener("mousemove",J),document.removeEventListener("mouseup",Q)};document.addEventListener("mousemove",J),document.addEventListener("mouseup",Q)},O.$$dblclick=()=>{V(!0)},K(O,fe(Ki,{get children(){return[fe(We,{get when(){return c()==="single"},get children(){var k=vi(),W=M;return typeof W=="function"?_t(W,k):M=k,X(z=>{var G=B(),D=Re((I().value??[])[o()]);return G!==z.e&&((z.e=G)!=null?k.style.setProperty("transform",G):k.style.removeProperty("transform")),D!==z.t&&pe(k,"src",z.t=D),z},{e:void 0,t:void 0}),k}}),fe(We,{get when(){return c()==="mosaic"},get children(){var k=Hs(),W=k.firstChild;k.$$dblclick=()=>{V(!0)};var z=M;return typeof z=="function"?_t(z,k):M=k,K(W,()=>U().map((G,D)=>(()=>{var J=Us(),Q=J.firstChild;return J.$$click=()=>{s(D)},X(ae=>{var ye=`${R().imageWidth}px`,Ce=`${R().imageHeight}px`,Qe=Re(G);return ye!==ae.e&&((ae.e=ye)!=null?J.style.setProperty("width",ye):J.style.removeProperty("width")),Ce!==ae.t&&((ae.t=Ce)!=null?J.style.setProperty("height",Ce):J.style.removeProperty("height")),Qe!==ae.a&&pe(Q,"src",ae.a=Qe),ae},{e:void 0,t:void 0,a:void 0}),J})())),X(G=>{var D=B(),J=`${R().containerWidth}px`,Q=`${R().containerHeight}px`;return D!==G.e&&((G.e=D)!=null?k.style.setProperty("transform",D):k.style.removeProperty("transform")),J!==G.t&&((G.t=J)!=null?W.style.setProperty("width",J):W.style.removeProperty("width")),Q!==G.a&&((G.a=Q)!=null?W.style.setProperty("height",Q):W.style.removeProperty("height")),G},{e:void 0,t:void 0,a:void 0}),k}}),fe(We,{get when(){return c()==="flipbook"},get children(){return[(()=>{var k=Rs(),W=k.firstChild,z=W.nextSibling,G=z.nextSibling,D=G.nextSibling;return z.$$input=J=>{y({...h(),[r()]:Math.max(1,parseInt(J.currentTarget.value,10))})},D.addEventListener("change",()=>{A(!_())}),X(()=>z.value=h()[r()]??12),X(()=>D.checked=_()),k})(),(()=>{var k=vi(),W=M;return typeof W=="function"?_t(W,k):M=k,X(z=>{var G=B(),D=Re((I().value??[])[d()]);return G!==z.e&&((z.e=G)!=null?k.style.setProperty("transform",G):k.style.removeProperty("transform")),D!==z.t&&pe(k,"src",z.t=D),z},{e:void 0,t:void 0}),k})()]}})]}}),T),T.$$click=()=>{V(!0)},K(T,(()=>{var k=oe(()=>c()==="mosaic");return()=>k()?parseFloat((R().ratio*v()).toFixed(2)):parseFloat(v().toFixed(2))})(),L),C})()]:null})()),X(()=>{var P,C;return w.classList.toggle("hasMultiple",((C=(P=I())==null?void 0:P.value)==null?void 0:C.length)>0)}),w})()};Ze(["dblclick","mousedown","input","click"]);const Ks=Object.freeze(Object.defineProperty({__proto__:null,ImagePreviews:Fs,localStoragePreviewImagesKey:bt},Symbol.toStringTag,{value:"Module"}));var ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Dn={},no={};Object.defineProperty(no,"__esModule",{value:!0});var Ne={},Vs=ot&&ot.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(Ne,"__esModule",{value:!0});Ne.TokenReader=Ne.TokenError=Ne.tokenizePrompt=void 0;function Ws(t){var e=[],n="",i=0,o=0,s=!1;function r(){n!==""&&(e.push([n,i]),n=""),i=o}function l(p){n+=p,o++}function a(){o++}for(var u=0,c=t.replace(/Ôºå/g,",").replace(/Ôºö/g,":").replace(/Ôºà/g,"(").replace(/Ôºâ/g,")");u<c.length;u++){var g=c[u];if(s)s=!1,l(g);else switch(g){case"\\":{s=!0,l(g);break}case"(":case")":case"[":case"]":case"<":case">":case":":case",":case"|":{r(),l(g),r();break}case" ":{a(),r();break}default:l(g)}}return r(),e}Ne.tokenizePrompt=Ws;var Bn=function(t){Vs(e,t);function e(n,i,o){var s=t.call(this,n)||this;return s.token=i,s.position=o,s}return e}(Error);Ne.TokenError=Bn;var Gs=function(){function t(e){this.tokens=e,this.index=0}return t.prototype.position=function(){if(this.index<this.tokens.length)return this.tokens[this.index][1]},t.prototype.look=function(){if(this.index<this.tokens.length)return this.tokens[this.index][0]},t.prototype.lookMany=function(e){return this.tokens.slice(this.index,this.index+e).map(function(n){var i=n[0];return i})},t.prototype.next=function(){this.index<this.tokens.length&&this.index++},t.prototype.error=function(e){var n=this.look();if(n===void 0)throw new Bn("Error happened at the end of the input: ".concat(e));var i=this.position();throw new Bn("Error happened at (".concat(n,",").concat(i,"):").concat(e),n,i)},t}();Ne.TokenReader=Gs;var cn={};Object.defineProperty(cn,"__esModule",{value:!0});cn.parsePrompt=void 0;var _n=Ne;function io(t){return t.replace(/\\(.)/g,"$1")}function Ys(t){var e=[];e:for(;;){var n=t.look();switch(n){case"(":case")":case"[":case"]":case"<":case">":case":":case",":case"|":case void 0:break e;default:e.push(n),t.next()}}if(e.length===0)t.error("Tag expected");else return{kind:"tag",name:e.map(io).join(" "),tokens:e}}function Xs(t){t.next();for(var e=tn(t,!1);;){var n=t.lookMany(2),i=n[0],o=n[1];if(i!==":"||!Number.isNaN(Number.parseFloat(o)))break;t.next(),e.push.apply(e,tn(t,!1))}if(t.look()===":"){t.next();var s=ro(t),r=s[0],l=s[1];return t.look()===","&&t.next(),(t.look()===")"||t.look()==="}"||t.look()===void 0)&&t.next(),{kind:"ew",weight:r,weightText:l,contents:e}}return(t.look()===")"||t.look()==="}"||t.look()===void 0)&&t.next(),{kind:"pw",contents:e}}function Js(t){t.next();var e=tn(t,!1);return(t.look()==="]"||t.look()==="}"||t.look()===void 0)&&t.next(),{kind:"nw",contents:e}}function oo(t,e){var n=t.look();switch(n){case"(":case")":case"[":case"]":case"<":case">":case":":case",":case void 0:t.error("".concat(e," expected"));default:return io(n)}}function qs(t){var e=oo(t,"Filename");return t.next(),e}function so(t,e){function n(c){var g=Number.parseInt(c);return!Number.isNaN(g)&&"".concat(g)===c}{var i=t.lookMany(3),o=i[0],s=i[1],r=i[2];if(n(o)&&s===","&&n(r))return t.next(),t.next(),t.next(),[Number.parseFloat("".concat(o,".").concat(r)),"".concat(o).concat(s).concat(r)]}{var l=t.lookMany(2),o=l[0],s=l[1];if(o.endsWith(".")&&n(o.substring(0,o.length-1))&&n(s))return t.next(),t.next(),[Number.parseFloat("".concat(o).concat(s)),"".concat(o," ").concat(s)]}var a=oo(t,e),u=Number.parseFloat(a);return Number.isNaN(u)&&t.error("Incorrect ".concat(e.toLowerCase()," format: ").concat(a)),t.next(),[u,a]}function ro(t){return so(t,"Weight")}function Zs(t){return so(t,"Multiplier")}function Qs(t,e){t.next(),t.next(),t.look()!==":"&&t.error('":" expected'),t.next();var n=qs(t);if(t.look()===":"){t.next();var i=Zs(t),o=i[0],s=i[1];if(t.look()===">")return t.next(),{kind:e,filename:n,multiplier:o,multiplierText:s}}if(t.look()===">")return t.next(),{kind:e,filename:n};t.next(),t.error('">" expected')}function er(t,e){switch(t.look()){case"(":return Xs(t);case"[":return Js(t);case"<":{var n=t.lookMany(2)[1];switch(n){case"lora":case"hypernet":return Qs(t,n);default:{t.next();return}}break}case",":t.error("Prompt expected");default:{var i=Ys(t);if(e&&t.look()===":"&&!Number.isNaN(Number.parseFloat(t.lookMany(2)[1]))){t.next();var o=ro(t),s=o[0],r=o[1];return{kind:"ew",weight:s,weightText:r,contents:[i]}}else return i}}}function tn(t,e){for(var n=[];;){var i=t.look();switch(i){case",":{t.next();break}case":":case")":case"]":case">":case"|":case void 0:return n;default:{var o=er(t,e);o!==void 0&&n.push(o)}}}}function tr(t){var e,n=typeof t=="string"?new _n.TokenReader((0,_n.tokenizePrompt)(t)):t instanceof Array?new _n.TokenReader(t):t,i=[],o=!1;e:for(;;){o=!1;t:for(;;)switch(n.look()){case"|":{o=!0,n.next();break}case")":case"]":case">":case":":{n.next();continue e}case void 0:return i;default:break t}var s=tn(n,!0);o||i.length===0?i.push({kind:"prompt",contents:s}):(e=i[i.length-1].contents).push.apply(e,s)}}cn.parsePrompt=tr;var un={};Object.defineProperty(un,"__esModule",{value:!0});un.printPrompt=void 0;function Ft(t){for(var e="",n=!1,i=0,o=t;i<o.length;i++){var s=o[i];switch(s.kind==="tag"&&n?e+=", ":e!==""&&(e+=" "),s.kind){case"pw":{e+="(".concat(Ft(s.contents),")");break}case"nw":{e+="[".concat(Ft(s.contents),"]");break}case"ew":{e+="(".concat(Ft(s.contents),":").concat(s.weightText?s.weightText:s.weight,")");break}case"lora":case"hypernet":{e+="<".concat(s.kind,":").concat(s.filename,":").concat(s.multiplierText?s.multiplierText:s.multiplier,">");break}default:e+=s.name}n=s.kind==="tag"}return e}function nr(t){return Ft(t.contents)}un.printPrompt=nr;var dn={};Object.defineProperty(dn,"__esModule",{value:!0});dn.evaluatePrompt=void 0;function Kt(t,e,n,i){for(var o,s,r=0,l=t;r<l.length;r++){var a=l[r];switch(a.kind){case"pw":{Kt(a.contents,e*n,n,i);break}case"nw":{Kt(a.contents,e/n,n,i);break}case"ew":{Kt(a.contents,e*a.weight,n,i);break}case"lora":{i.loras.push({filename:a.filename,multiplier:(o=a.multiplier)!==null&&o!==void 0?o:1});break}case"hypernet":{i.hypernets.push({filename:a.filename,multiplier:(s=a.multiplier)!==null&&s!==void 0?s:1});break}default:i.tags.push({tag:a.name,weight:e})}}}function ir(t,e){e===void 0&&(e=1.1);var n={tags:[],loras:[],hypernets:[]};return Kt(t.contents,1,e,n),n}dn.evaluatePrompt=ir;(function(t){var e=ot&&ot.__createBinding||(Object.create?function(i,o,s,r){r===void 0&&(r=s);var l=Object.getOwnPropertyDescriptor(o,s);(!l||("get"in l?!o.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return o[s]}}),Object.defineProperty(i,r,l)}:function(i,o,s,r){r===void 0&&(r=s),i[r]=o[s]}),n=ot&&ot.__exportStar||function(i,o){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(o,s)&&e(o,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(no,t),n(Ne,t),n(cn,t),n(un,t),n(dn,t)})(Dn);var or=Y('<div class=prompt><div class=arrows><div class="arrow down">‚ñº</div></div><label><input></label><div class=weight title="Click scroll wheel button to reset to 1"></div><button class=less>- 0.05</button><input type=range step=0.05><button class=more>+ 0.05</button><button class=remove>X</button><input title="Toggle to temporarily disable"type=checkbox>'),sr=Y('<div class="arrow up">‚ñ≤'),rr=Y('<div class=promptTweaker><div class=buttons><button>- 0.05 All</button><button title="Move all values 5% towards 1">Compress 5%</button><button title="Converts weights so they all add up to 1">Normalize</button><button>+ 0.05 All</button></div><div class=promptTweakerPrompts>');const Vt="üîí",Wt="üîè",lr=t=>{const e=n=>{var i,o;return n.kind==="pw"&&(n={kind:"ew",weight:1.1,weightText:"1.1",contents:(i=n.contents)==null?void 0:i.map(e)}),n.kind==="nw"&&(n={kind:"ew",weight:.9,weightText:"0.9",contents:(o=n.contents)==null?void 0:o.map(e)}),n};return t.map(n=>(n.contents=n.contents.flatMap(i=>{const o=e(i);return lo(o)}),n))};function lo(t,e=1){if(t.contents&&t.contents.length>0)return t.contents.flatMap(n=>lo(n,e*(t.weight??1)));{const n=Un(e);return{kind:"ew",weight:n,weightText:n.toString(),contents:[t]}}}function ar(t,e,n){return t+n*(e-t)}function we(t,e){if(t){if(typeof t[e]<"u")return t[e];if(t.contents)for(const n of t.contents){const i=we(n,e);if(i!==void 0)return i}}}const Un=t=>parseFloat(t.toFixed(2)),cr=t=>{const[e,n]=en([]),i=()=>{t.update([{contents:e}].map(Dn.printPrompt).join(", "))};Se(()=>{const p=Dn.parsePrompt(t.prompt),d=lr(p);n(d[0]?Rn(d[0].contents):[])});const o=oe(()=>Math.min(...e.map(p=>p.weight??1))),s=oe(()=>Math.max(...e.map(p=>p.weight??1))),r=(p,d)=>{const f=e.findIndex(x=>we(x,"name")===p),h=f+d;if(h<0)return;const y=e.length;if(h===y)return;const _=JSON.parse(JSON.stringify(e)),A=_[f],b=_[h];_[h]=A,_[f]=b,n(Rn(_)),i()},l=p=>{for(const[d,f]of e.entries())n(d,"weight",Un(p(f.weight??-666))),n(d,"weightText",(f.weight??-666).toString());i()},a=(p,d,f="weight")=>{var y;const h=e.findIndex(_=>we(_,"name")===p);f==="weight"?(n(h,f,Un(d(e[h][f]))),n(h,"weightText",(y=e[h].weight)==null?void 0:y.toString())):f==="name"?n(h,"contents",0,f,d(e[h][f])):alert(`Implement ${f}`),i()},u=p=>{const d=p.deltaY<0?.05:-.05;l(f=>f+d)},c=()=>{const p=e.reduce((d,f)=>d+(f.weight??0),0);l(d=>parseFloat((d/p).toFixed(3)))},g=(p,d)=>{const f=()=>we(p,"name")??"",h=()=>f().includes(Vt)&&f().includes(Wt);return(()=>{var y=or(),_=y.firstChild,A=_.firstChild,b=_.nextSibling,x=b.firstChild,j=b.nextSibling,I=j.nextSibling,B=I.nextSibling,M=B.nextSibling,F=M.nextSibling,S=F.nextSibling;return y.addEventListener("wheel",$=>{const N=$.deltaY<0?.05:-.05;a(f(),H=>H+N)}),K(_,(()=>{var $=sr();return $.$$click=()=>{r(f(),-1)},$})(),A),A.$$click=()=>{r(f(),1)},x.addEventListener("change",$=>{const N=$.currentTarget.value;a(f(),()=>N,"name")}),j.$$mousedown=$=>{$.which===2&&(a(f(),()=>1),i())},j.$$dblclick=()=>{document.querySelector(".comfy-queue-btn").click()},K(j,()=>(we(p,"weight")??1).toFixed(2)),I.$$click=()=>{a(f(),$=>$-.05)},B.addEventListener("change",$=>{a(f(),()=>parseFloat($.currentTarget.value))}),B.$$input=$=>{const N=e[d()].weight;!N||N<0||N>2||a(f(),()=>parseFloat($.currentTarget.value))},M.$$click=()=>{a(f(),$=>$+.05)},F.$$click=()=>{n(e.filter($=>we($,"name")!==we(p,"name"))),i()},S.addEventListener("change",()=>{h()?a(f(),()=>{var $;return($=we(p,"name"))==null?void 0:$.replace(Vt,"").replace(Wt,"")},"name"):a(f(),()=>Vt+(we(p,"name")??"")+Wt,"name"),i()}),X($=>{var N=!!h(),H=we(p,"name"),E=Math.min(o(),0),R=Math.max(s(),2);return N!==$.e&&y.classList.toggle("tmp",$.e=N),H!==$.t&&pe(x,"title",$.t=H),E!==$.a&&pe(B,"min",$.a=E),R!==$.o&&pe(B,"max",$.o=R),$},{e:void 0,t:void 0,a:void 0,o:void 0}),X(()=>x.value=we(p,"name")),X(()=>B.value=we(p,"weight")),X(()=>S.checked=!h()),y})()};return(()=>{var p=rr(),d=p.firstChild,f=d.firstChild,h=f.nextSibling,y=h.nextSibling,_=y.nextSibling,A=d.nextSibling;return d.addEventListener("wheel",u),f.$$click=()=>{l(b=>b-.05)},h.$$click=()=>{l(b=>ar(b,1,.05))},y.$$click=c,_.$$click=()=>{l(b=>b+.05)},K(A,fe(Fi,{each:e,children:g})),p})()};Ze(["click","dblclick","mousedown","input"]);const _i="",ur=async()=>{const{api:t}=await kt(()=>import(`${_i}/scripts/api.js`),__vite__mapDeps([])),{app:e}=await kt(()=>import(`${_i}/scripts/app.js`),__vite__mapDeps([]));let n,i={};async function o(){i={};const f=ze().filter(h=>Es(h)).filter(h=>he(h));for(const h of f.filter(_e)){i[h.id]=[];const y=q(h);for(const _ of f){const A=q(_);y===A&&h.id!==_.id&&i[h.id].push(_.id)}}}async function s(){const d=JSON.parse(JSON.stringify(await n.apply(e))),f={},h={};for(const _ of d.workflow.nodes.filter(he)){const A=q(_);if(_.inputs[0].link){const x=d.workflow.links.find(j=>{const[I,B,M,F,S,$]=j;return F===_.id});if(!x)continue;h[A]={originId:x[1],originIndex:x[2]};continue}f[_.id]=A}d.workflow.nodes=[],d.workflow.links=[],d.output=Object.fromEntries(Object.entries(d.output).filter(([_,A])=>A.class_type!==Te).map(([_,A])=>(A.inputs=Object.fromEntries(Object.entries(A.inputs).map(([b,x])=>{if(Array.isArray(x)){const[j,I]=x,B=f[j],M=h[B];if(M){const F=xe(M.originId);if(F&&F.type==="PrimitiveNode")return[b,q(F)]}return!B||!M?[b,x]:[b,[M.originId.toString(),M.originIndex]]}else return[b,x]})),[_,A])));const y=new RegExp(`${Vt}.*?${Wt}`,"g");return d.output=Object.fromEntries(Object.entries(d.output).map(([_,A])=>(A.inputs=Object.fromEntries(Object.entries(A.inputs).map(([b,x])=>Array.isArray(x)?[b,x]:typeof x=="string"?[b,x.replaceAll(y,"").replace(/\(:\d+\.?\d+?\)/g,"")]:[b,x])),[_,A]))),localStorage.debugOutput&&console.info(JSON.stringify(d,null,"  ")),d}let r=!1,l=!1,a;const u=LGraphCanvas.prototype.showLinkMenu,c=function(d,f){var N,H,E,R,V,U,m,v,w,P,C,O,T;if(!f.shiftKey)return u.apply(this,[d,f]),!1;const{origin_id:h,origin_slot:y,target_id:_,target_slot:A,type:b}=d,x=graph.getNodeById(h),j=graph.getNodeById(_);if(!x||!j)return!1;let I=Rt(((N=j.getInputInfo(A))==null?void 0:N.name)??b.toLowerCase());I||(I=Rt(((E=(H=x==null?void 0:x.outputs)==null?void 0:H[y])==null?void 0:E.name)??((V=(R=x==null?void 0:x.outputs)==null?void 0:R[y])==null?void 0:V.type.toString())??`newVariable_${h}_${_}`));let B=!1,M=!1;if(he(x))I=q(x),M=!0;else{if(x.outputs[y].links)for(const L of((m=(U=x.outputs)==null?void 0:U[y])==null?void 0:m.links)??[]){const k=xe(((P=(w=(v=x.graph)==null?void 0:v.links)==null?void 0:w[L])==null?void 0:P.target_id)??-1);k&&he(k)&&_e(k)&&(I=q(k),M=!0)}if(!M){for(const L of ze().filter(he)){const k=q(L);if(!(I===k&&_e(L)))continue;const z=(C=L.inputs[0])==null?void 0:C.link;((T=(O=L.graph)==null?void 0:O.links[z])==null?void 0:T.origin_id)===x.id?M=!0:B=!0}B&&(I+=`_${h}_${_}`)}}let F;if(!M){F=LiteGraph.createNode("mape Variable");const L=x.getConnectionPos(!1,y);F.pos=[L[0]+20,L[1]],F.inputs[0].name=b,F.inputs[0].type=b,F.inputs[0].widget=j.inputs[A].widget,be(F,I),graph.add(F),x.connect(y,F,0),F.flags.collapsed=!0,F==null||F.setSize(F.computeSize())}const S=LiteGraph.createNode("mape Variable"),$=j.getConnectionPos(!0,A);return S.pos=[$[0]-150,$[1]],graph.add(S),be(S,I),S.flags.collapsed=!0,S==null||S.setSize(S.computeSize()),S.connect(0,j,A),setTimeout(()=>{!B||ee("alwaysPromptVariableName")||window.setPrompt("Variable name",this.last_mouse_position,L=>{be(S,L),F&&be(F,L)},I)},100),!1},g=d=>{setTimeout(()=>{for(const f of d.nodes){if(f.type!=="PrimitiveNode")continue;const h=xe(f.id);for(const[y,_]of(f.widgets_values??[]).entries())h.widgets[y].value=_}e.graph.setDirtyCanvas(!0,!0),He()})},p={name:"cg.customnodes.mape_helpers",async beforeRegisterNodeDef(d,f){for(const y of["onAdded","onConnectInput","onConnectionsChange","onConnectOutput","onRemoved","onSelected","onDeselected","onPropertyChanged","onWidgetChanged","onMouseMove"]){const _=d.prototype[y];d.prototype[y]=function(...A){He(),_==null||_.apply(this,A)}}if(f.display_name!==Te){const y=d.prototype.onDblClick;d.prototype.onDblClick=function(...A){if(y==null||y.apply(this,A),!ee("dblClickToRename"))return;const b=prompt("Name",this.title);b&&(this.title=b)};const _=d.prototype.onDrawForeground;d.prototype.onDrawForeground=function(...A){if(ee("profileNodes")){const[b]=A;Ns(b,this.executionDuration||"")}return _==null?void 0:_.apply(this,A)};return}const h=d.prototype.onConnectionsChange;d.prototype.onConnectionsChange=function(...y){const[_]=y;if((_===2?"output":"input")==="output"){if(_e(this)){this.disconnectOutput(0);return}}else if(lt(this)){this.disconnectInput(0);return}he(this)&&_==1&&mi(this),h==null||h.apply(this,y)},d.prototype.getTitle=function(){const y=this,_=_e(y),A=ee(_?"setIcon":"getIcon");d.title_color=ee(_?"setBackgroundColor":"getBackgroundColor");const b=q(y);return b?`${A}${b}`:y.title},d.prototype.onSelected=function(){r=!0},d.prototype.onMouseEnter=function(){a=this,l=!0},d.prototype.onMouseLeave=function(){a=void 0,l=!1},d.prototype.onDeselected=()=>{r=!1},d.prototype.onRemoved=()=>{r=!1},d.prototype.onDblClick=function(){const y=this;y.flags.collapsed=!y.flags.collapsed}},async nodeCreated(d){if(d.IS_MAPE_VARIABLE=he(d),!d.IS_MAPE_VARIABLE)return;const f=d.configure;d.configure=function(...h){f.apply(this,h),d.inputs=h[0].inputs.map(y=>(y.widget=null,setTimeout(()=>{y.widget={}}),y)),mi(d)}},async init(d){const f=d.graph.onConfigure;d.graph.onConfigure=function(...h){const[y]=h;f.apply(this,h),g(y)}},async setup(){var F;n=e.graphToPrompt,window.mapeHackSettings&&g(window.mapeHackSettings),ee("replaceSearch")&&(String.prototype.__indexOf=String.prototype.indexOf,String.prototype.indexOf=function(S,$){var H;const N=this;return(H=new Error().stack)!=null&&H.match(/refreshHelper/)?Ts(S,N)?1:-1:this.__indexOf(S,$)}),document.addEventListener("keydown",S=>{S.key==="z"&&S.ctrlKey&&S.preventDefault()});let d=!0;e.graphToPrompt=async function(){return d?s():n.apply(e)};for(const S of["status","reconnecting","reconnected","executing","executed","execution_start","execution_error","b_preview","progress"])t.addEventListener(S,He);const f=new Map;let h=0;for(const S of["executing"])t.addEventListener(S,$=>{var R;const N=((R=$==null?void 0:$.detail)==null?void 0:R.node)??($==null?void 0:$.detail),H=xe(N);H&&(H.executionDuration="");const E=f.get(h);if(f.delete(h),h&&E){const V=Date.now()-E,U=xe(h);U&&(U.executionDuration=`${(V/1e3).toFixed(2)}s`)}h=N,f.set(N,Date.now())});let y;t.addEventListener("progress",S=>{clearTimeout(y);const{value:$,max:N,node:H}=S.detail,E=xe(H);$&&N&&H&&(document.title=`${E&&E.title?`${E.title}: `:""}${$}/${N} (${($/N*100).toFixed(0)}%)`,$===N&&(document.title="Completed!",y=setTimeout(()=>{document.title="ComfyUI"},2e3))),He()});const _=e.ui.dialog.show;window.mapeErrors=[],e.ui.dialog.show=function(...S){setTimeout(()=>{for(const[$,N]of Object.entries(e.lastNodeErrors)){const H=xe(parseFloat($));for(const E of N.errors)window.mapeErrors.push({text:E.message,type:E.details,node:H})}He(),window.showWarnings(!0)}),_.apply(this,S)};const A=document.getElementById("comfy-save-button");if(A){const S=A.onclick;A.onclick=function($){d=!1,S($),d=!0}}const b=document.getElementById("comfy-dev-save-api-button");if(b){const S=b.onclick;b.onclick=function($){d=!1,S($),d=!0}}const x=LGraphCanvas.prototype.drawFrontCanvas;LGraphCanvas.prototype.drawFrontCanvas=function(...S){if(x.apply(this,S),!r&&!l)return;let $=xs();if(!$&&a&&ee("showAllConnectionsOnNodeHover")&&($=a),!$&&a&&ee("showConnectionOnNodeHover")&&(lt(a)?$=Cs(a):$=a),!$||!e.canvas)return;const N=!r&&l&&!ee("showAllConnectionsOnNodeHover")&&ee("showConnectionOnNodeHover");o();const H=this.ctx;for(const E of ze().filter(R=>he(R))){const R=E;if(N&&E.id!==$.id)continue;E.id,R.id,lt(E);const V=i[R.id];if(!V)continue;const U=window.innerWidth,m=window.innerHeight;for(const v of V){const w=xe(v);if(!w){console.error("failed",R.id,v);continue}const P=q($),C=q(w);if(!ee("showAllConnectionsOnFocus")&&P!==C)continue;const O=R.getConnectionPos(!0,0),T=w.getConnectionPos(!0,0),L=e.canvas.ds.scale,k=e.canvas.ds.offset;O[0]=O[0]*L+k[0]*L,O[1]=O[1]*L+k[1]*L,T[0]=T[0]*L+k[0]*L,T[1]=T[1]*L+k[1]*L;const W=T[0]-O[0],z=T[1]-O[1],G=LiteGraph.LEFT,D=Math.abs(z)>Math.abs(W)?z>0?LiteGraph.DOWN:LiteGraph.UP:W<0?LiteGraph.LEFT:LiteGraph.RIGHT,J=O[0]>0&&O[1]>0&&O[0]<U&&O[1]<m,Q=T[0]>0&&T[1]>0&&T[0]<U&&T[1]<m;if(!J&&!Q)continue;H.save(),H.shadowColor="#000",H.shadowBlur=15,H.lineCap="round";const ye=P===C,Ce=ee("animateAllNodes")||ye&&ee("animateSelectedNode")||!1;e.canvas.renderLink(H,O,T,void 0,!0,Ce,ye?`rgba(255,244,53,${ee("selectedNodeConnectionOpacity")/100})`:`rgba(255,255,255,${ee("nodeConnectionOpacity")/100})`,D,G),H.restore()}}},LGraphCanvas.prototype.showLinkMenu=c;const j=LGraphCanvas.prototype.showConnectionMenu;LGraphCanvas.prototype.showConnectionMenu=function(...S){I||(this.use_original_menu=!0,j.apply(this,S),this.use_original_menu=!1)};let I=!1,B=!1;document.addEventListener("keydown",S=>{B=S.ctrlKey,I=S.shiftKey}),e.canvas._mousemove_callback=()=>{if(!ee("organizeSideNodes"))return;const S=Object.values(graph.list_of_graphcanvas[0].selected_nodes);pi(S)},document.addEventListener("keyup",S=>{var H;const $=document.activeElement;if($.tagName==="INPUT"&&($.type==="text"||$.type==="number")||$.tagName==="TEXTAREA")return;if(S.key==="A"&&S.shiftKey){document.querySelector(".comfy-queue-btn").click();return}if(S.key==="ArrowLeft"&&S.shiftKey){const E=Object.values(graph.list_of_graphcanvas[0].selected_nodes),R=Math.min(...E.map(U=>U.pos[0])),V=Math.max(...E.map(U=>U.size[0]));for(const U of E)U.pos=[R,U.pos[1]],ee("resizeNodeWidthOnAlignment")&&(U.size=[V,U.size[1]]);return}if(S.key==="ArrowDown"&&S.shiftKey){const E=Object.values(graph.list_of_graphcanvas[0].selected_nodes).filter(m=>!he(m)),R=Math.min(...E.map(m=>m.pos[1])),V=ee("nodeAlignOffsetY");let U=0;for(const m of E.sort((v,w)=>v.pos[1]-w.pos[1])){m.pos=[m.pos[0],R+U];const v=m.size[1]+V;U+=v}return}if(S.key==="ArrowUp"&&S.shiftKey){const E=Object.values(graph.list_of_graphcanvas[0].selected_nodes),R=Math.min(...E.map(V=>V.pos[1]));for(const V of E)V.pos=[V.pos[0],R];return}if(S.key==="O"&&S.shiftKey){const E=Object.values(graph.list_of_graphcanvas[0].selected_nodes);pi(E,!0)}const N=Object.values(graph.list_of_graphcanvas[0].selected_nodes)[0];if(!(!N||!N.type||N.type!==Te)){if(S.key==="w"){const E=q(N);setTimeout(()=>{var R,V,U;window.setPrompt("Variable name",((U=(V=(R=N.graph)==null?void 0:R.list_of_graphcanvas)==null?void 0:V[0])==null?void 0:U.last_mouse_position)??[document.body.clientWidth/2,document.body.clientHeight/2],m=>{if(m){localStorage[`mape_tweak_${E}`]&&(localStorage[`mape_tweak_${m}`]=localStorage[`mape_tweak_${E}`],delete localStorage[`mape_tweak_${E}`]);for(const v of graph._nodes)q(v)===E&&be(v,m);He()}},E)})}if(S.key==="s"){const E=q(N);for(const R of graph._nodes)q(R)===E&&(H=R.inputs)!=null&&H[0].link&&at(R)}if(S.key==="ArrowLeft"||S.key==="ArrowRight"){const E=S.key==="ArrowLeft"?-1:1,R=N,V=q(R);let U=graph._nodes.filter(C=>q(C)===V);const m=U.find(_e);if(!m)return;U=U.sort((C,O)=>{const T=zn(m.pos[0],m.pos[1],C.pos[0],C.pos[1]),L=zn(m.pos[0],m.pos[1],O.pos[0],O.pos[1]);return T-L});const w=U.findIndex(C=>C.id===R.id)+E,P=U.length;if(w>P-1||w<0)return;at(U[w])}if(S.key.match(/^\d+$/)){const E=parseFloat(S.key)-1,V=q(N),m=graph._nodes.filter(v=>q(v)===V)[E];m&&at(m)}}}),document.body.addEventListener("keyup",()=>{B=!1,I=!1});let M=(F=e.canvas)==null?void 0:F.allow_searchbox;Object.defineProperty(e.canvas,"allow_searchbox",{get:function(){var N;const S=this.graph.getGroupOnPos(...this.canvas_mouse),$=this.connecting_node&&he(this.connecting_node);if(!I||$)return M;if(this.connecting_input){const H=Rt((N=this.connecting_input.name)==null?void 0:N.toLowerCase()),E=LiteGraph.createNode("mape Variable");E.pos=[this.canvas_mouse[0]+10,this.canvas_mouse[1]],graph.add(E);const R=this.connecting_input.slot_index;return be(E,H),E.connect(0,this.connecting_node,R),E.flags.collapsed=!0,E==null||E.setSize(E.computeSize()),setTimeout(()=>{var V,U;window.setPrompt("Variable name",((U=(V=graph.list_of_graphcanvas)==null?void 0:V[0])==null?void 0:U.last_mouse_position)??[document.body.clientWidth/2,document.body.clientHeight/2],m=>{be(E,m)},H)}),!1}else if(this.connecting_output){const H=Rt(this.connecting_output.name??this.connecting_output.type),E=LiteGraph.createNode("mape Variable");E.pos=[this.canvas_mouse[0]+10,this.canvas_mouse[1]],graph.add(E);const R=this.connecting_output.slot_index;if(be(E,H),this.connecting_node.connect(R,E,0),E.flags.collapsed=!0,E==null||E.setSize(E.computeSize()),!B)return setTimeout(()=>{var U,m;window.setPrompt("Variable name",((m=(U=graph.list_of_graphcanvas)==null?void 0:U[0])==null?void 0:m.last_mouse_position)??[document.body.clientWidth/2,document.body.clientHeight/2],v=>{be(E,v)},H)}),!1;const V=LiteGraph.createNode("mape Variable");return V.pos=[this.canvas_mouse[0]+10,this.canvas_mouse[1]+50],graph.add(V),be(V,H),V.flags.collapsed=!0,V==null||V.setSize(V.computeSize()),setTimeout(()=>{var U,m;window.setPrompt("Variable name",((m=(U=graph.list_of_graphcanvas)==null?void 0:U[0])==null?void 0:m.last_mouse_position)??[document.body.clientWidth/2,document.body.clientHeight/2],v=>{be(E,v),be(V,v)},H)}),!1}return S&&I&&ee("dblClickToRenameGroup")?(I=!1,setTimeout(()=>{const H=prompt("Change group name",S.title);H&&(S.title=H,e.graph.setDirtyCanvas(!0,!0))},100),!1):!0},set:function(S){M=S}})}};e.registerExtension(p)},dr=Object.freeze(Object.defineProperty({__proto__:null,registerPlugin:ur},Symbol.toStringTag,{value:"Module"})),bn=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function $n(t,e,n,i){t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on".concat(e),n)}function gt(t,e,n,i){t.removeEventListener?t.removeEventListener(e,n,i):t.deachEvent&&t.deachEvent("on".concat(e),n)}function ao(t,e){const n=e.slice(0,e.length-1);for(let i=0;i<n.length;i++)n[i]=t[n[i].toLowerCase()];return n}function co(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const e=t.split(",");let n=e.lastIndexOf("");for(;n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}function fr(t,e){const n=t.length>=e.length?t:e,i=t.length>=e.length?e:t;let o=!0;for(let s=0;s<n.length;s++)i.indexOf(n[s])===-1&&(o=!1);return o}const At={backspace:8,"‚å´":8,tab:9,clear:12,enter:13,"‚Ü©":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"‚á™":20,",":188,".":190,"/":191,"`":192,"-":bn?173:189,"=":bn?61:187,";":bn?59:186,"'":222,"[":219,"]":221,"\\":220},Ee={"‚áß":16,shift:16,"‚å•":18,alt:18,option:18,"‚åÉ":17,ctrl:17,control:17,"‚åò":91,cmd:91,command:91},Fn={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},ge={16:!1,18:!1,17:!1,91:!1},re={};for(let t=1;t<20;t++)At["f".concat(t)]=111+t;let te=[],$t=null,uo="all";const je=new Map,It=t=>At[t.toLowerCase()]||Ee[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),hr=t=>Object.keys(At).find(e=>At[e]===t),pr=t=>Object.keys(Ee).find(e=>Ee[e]===t);function fo(t){uo=t||"all"}function Et(){return uo||"all"}function gr(){return te.slice(0)}function mr(){return te.map(t=>hr(t)||pr(t)||String.fromCharCode(t))}function vr(){const t=[];return Object.keys(re).forEach(e=>{re[e].forEach(n=>{let{key:i,scope:o,mods:s,shortcut:r}=n;t.push({scope:o,shortcut:r,mods:s,keys:i.split("+").map(l=>It(l))})})}),t}function yr(t){const e=t.target||t.srcElement,{tagName:n}=e;let i=!0;return(e.isContentEditable||(n==="INPUT"||n==="TEXTAREA"||n==="SELECT")&&!e.readOnly)&&(i=!1),i}function _r(t){return typeof t=="string"&&(t=It(t)),te.indexOf(t)!==-1}function br(t,e){let n,i;t||(t=Et());for(const o in re)if(Object.prototype.hasOwnProperty.call(re,o))for(n=re[o],i=0;i<n.length;)n[i].scope===t?n.splice(i,1).forEach(r=>{let{element:l}=r;return qn(l)}):i++;Et()===t&&fo(e||"all")}function $r(t){let e=t.keyCode||t.which||t.charCode;const n=te.indexOf(e);if(n>=0&&te.splice(n,1),t.key&&t.key.toLowerCase()==="meta"&&te.splice(0,te.length),(e===93||e===224)&&(e=91),e in ge){ge[e]=!1;for(const i in Ee)Ee[i]===e&&(ie[i]=!1)}}function ho(t){if(typeof t>"u")Object.keys(re).forEach(o=>{Array.isArray(re[o])&&re[o].forEach(s=>Dt(s)),delete re[o]}),qn(null);else if(Array.isArray(t))t.forEach(o=>{o.key&&Dt(o)});else if(typeof t=="object")t.key&&Dt(t);else if(typeof t=="string"){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];let[o,s]=n;typeof o=="function"&&(s=o,o=""),Dt({key:t,scope:o,method:s,splitKey:"+"})}}const Dt=t=>{let{key:e,scope:n,method:i,splitKey:o="+"}=t;co(e).forEach(r=>{const l=r.split(o),a=l.length,u=l[a-1],c=u==="*"?"*":It(u);if(!re[c])return;n||(n=Et());const g=a>1?ao(Ee,l):[],p=[];re[c]=re[c].filter(d=>{const h=(i?d.method===i:!0)&&d.scope===n&&fr(d.mods,g);return h&&p.push(d.element),!h}),p.forEach(d=>qn(d))})};function bi(t,e,n,i){if(e.element!==i)return;let o;if(e.scope===n||e.scope==="all"){o=e.mods.length>0;for(const s in ge)Object.prototype.hasOwnProperty.call(ge,s)&&(!ge[s]&&e.mods.indexOf(+s)>-1||ge[s]&&e.mods.indexOf(+s)===-1)&&(o=!1);(e.mods.length===0&&!ge[16]&&!ge[18]&&!ge[17]&&!ge[91]||o||e.shortcut==="*")&&(e.keys=[],e.keys=e.keys.concat(te),e.method(t,e)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function $i(t,e){const n=re["*"];let i=t.keyCode||t.which||t.charCode;if(!ie.filter.call(this,t))return;if((i===93||i===224)&&(i=91),te.indexOf(i)===-1&&i!==229&&te.push(i),["ctrlKey","altKey","shiftKey","metaKey"].forEach(l=>{const a=Fn[l];t[l]&&te.indexOf(a)===-1?te.push(a):!t[l]&&te.indexOf(a)>-1?te.splice(te.indexOf(a),1):l==="metaKey"&&t[l]&&te.length===3&&(t.ctrlKey||t.shiftKey||t.altKey||(te=te.slice(te.indexOf(a))))}),i in ge){ge[i]=!0;for(const l in Ee)Ee[l]===i&&(ie[l]=!0);if(!n)return}for(const l in ge)Object.prototype.hasOwnProperty.call(ge,l)&&(ge[l]=t[Fn[l]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(te.indexOf(17)===-1&&te.push(17),te.indexOf(18)===-1&&te.push(18),ge[17]=!0,ge[18]=!0);const o=Et();if(n)for(let l=0;l<n.length;l++)n[l].scope===o&&(t.type==="keydown"&&n[l].keydown||t.type==="keyup"&&n[l].keyup)&&bi(t,n[l],o,e);if(!(i in re))return;const s=re[i],r=s.length;for(let l=0;l<r;l++)if((t.type==="keydown"&&s[l].keydown||t.type==="keyup"&&s[l].keyup)&&s[l].key){const a=s[l],{splitKey:u}=a,c=a.key.split(u),g=[];for(let p=0;p<c.length;p++)g.push(It(c[p]));g.sort().join("")===te.sort().join("")&&bi(t,a,o,e)}}function ie(t,e,n){te=[];const i=co(t);let o=[],s="all",r=document,l=0,a=!1,u=!0,c="+",g=!1,p=!1;for(n===void 0&&typeof e=="function"&&(n=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(s=e.scope),e.element&&(r=e.element),e.keyup&&(a=e.keyup),e.keydown!==void 0&&(u=e.keydown),e.capture!==void 0&&(g=e.capture),typeof e.splitKey=="string"&&(c=e.splitKey),e.single===!0&&(p=!0)),typeof e=="string"&&(s=e),p&&ho(t,s);l<i.length;l++)t=i[l].split(c),o=[],t.length>1&&(o=ao(Ee,t)),t=t[t.length-1],t=t==="*"?"*":It(t),t in re||(re[t]=[]),re[t].push({keyup:a,keydown:u,scope:s,mods:o,shortcut:i[l],method:n,key:i[l],splitKey:c,element:r});if(typeof r<"u"&&window){if(!je.has(r)){const d=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return $i(h,r)},f=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;$i(h,r),$r(h)};je.set(r,{keydownListener:d,keyupListenr:f,capture:g}),$n(r,"keydown",d,g),$n(r,"keyup",f,g)}if(!$t){const d=()=>{te=[]};$t={listener:d,capture:g},$n(window,"focus",d,g)}}}function wr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(re).forEach(n=>{re[n].filter(o=>o.scope===e&&o.shortcut===t).forEach(o=>{o&&o.method&&o.method()})})}function qn(t){const e=Object.values(re).flat();if(e.findIndex(i=>{let{element:o}=i;return o===t})<0){const{keydownListener:i,keyupListenr:o,capture:s}=je.get(t)||{};i&&o&&(gt(t,"keyup",o,s),gt(t,"keydown",i,s),je.delete(t))}if((e.length<=0||je.size<=0)&&(Object.keys(je).forEach(o=>{const{keydownListener:s,keyupListenr:r,capture:l}=je.get(o)||{};s&&r&&(gt(o,"keyup",r,l),gt(o,"keydown",s,l),je.delete(o))}),je.clear(),Object.keys(re).forEach(o=>delete re[o]),$t)){const{listener:o,capture:s}=$t;gt(window,"focus",o,s),$t=null}}const wn={getPressedKeyString:mr,setScope:fo,getScope:Et,deleteScope:br,getPressedKeyCodes:gr,getAllKeyCodes:vr,isPressed:_r,filter:yr,trigger:wr,unbind:ho,keyMap:At,modifier:Ee,modifierMap:Fn};for(const t in wn)Object.prototype.hasOwnProperty.call(wn,t)&&(ie[t]=wn[t]);if(typeof window<"u"){const t=window.hotkeys;ie.noConflict=e=>(e&&window.hotkeys===ie&&(window.hotkeys=t),ie),window.hotkeys=ie}const Gt=window,Zn=Gt.ShadowRoot&&(Gt.ShadyCSS===void 0||Gt.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Qn=Symbol(),wi=new WeakMap;let po=class{constructor(e,n,i){if(this._$cssResult$=!0,i!==Qn)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(Zn&&e===void 0){const i=n!==void 0&&n.length===1;i&&(e=wi.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&wi.set(n,e))}return e}toString(){return this.cssText}};const kr=t=>new po(typeof t=="string"?t:t+"",void 0,Qn),fn=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((i,o,s)=>i+(r=>{if(r._$cssResult$===!0)return r.cssText;if(typeof r=="number")return r;throw Error("Value passed to 'css' function must be a 'css' function result: "+r+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+t[s+1],t[0]);return new po(n,t,Qn)},xr=(t,e)=>{Zn?t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet):e.forEach(n=>{const i=document.createElement("style"),o=Gt.litNonce;o!==void 0&&i.setAttribute("nonce",o),i.textContent=n.cssText,t.appendChild(i)})},ki=Zn?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const i of e.cssRules)n+=i.cssText;return kr(n)})(t):t;var kn;const nn=window,xi=nn.trustedTypes,Sr=xi?xi.emptyScript:"",Si=nn.reactiveElementPolyfillSupport,Kn={toAttribute(t,e){switch(e){case Boolean:t=t?Sr:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},go=(t,e)=>e!==t&&(e==e||t==t),xn={attribute:!0,type:String,converter:Kn,reflect:!1,hasChanged:go},Vn="finalized";let it=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(e){var n;this.finalize(),((n=this.h)!==null&&n!==void 0?n:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach((n,i)=>{const o=this._$Ep(i,n);o!==void 0&&(this._$Ev.set(o,i),e.push(o))}),e}static createProperty(e,n=xn){if(n.state&&(n.attribute=!1),this.finalize(),this.elementProperties.set(e,n),!n.noAccessor&&!this.prototype.hasOwnProperty(e)){const i=typeof e=="symbol"?Symbol():"__"+e,o=this.getPropertyDescriptor(e,i,n);o!==void 0&&Object.defineProperty(this.prototype,e,o)}}static getPropertyDescriptor(e,n,i){return{get(){return this[n]},set(o){const s=this[e];this[n]=o,this.requestUpdate(e,s,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||xn}static finalize(){if(this.hasOwnProperty(Vn))return!1;this[Vn]=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),e.h!==void 0&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const n=this.properties,i=[...Object.getOwnPropertyNames(n),...Object.getOwnPropertySymbols(n)];for(const o of i)this.createProperty(o,n[o])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const o of i)n.unshift(ki(o))}else e!==void 0&&n.push(ki(e));return n}static _$Ep(e,n){const i=n.attribute;return i===!1?void 0:typeof i=="string"?i:typeof e=="string"?e.toLowerCase():void 0}_$Eu(){var e;this._$E_=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(e=this.constructor.h)===null||e===void 0||e.forEach(n=>n(this))}addController(e){var n,i;((n=this._$ES)!==null&&n!==void 0?n:this._$ES=[]).push(e),this.renderRoot!==void 0&&this.isConnected&&((i=e.hostConnected)===null||i===void 0||i.call(e))}removeController(e){var n;(n=this._$ES)===null||n===void 0||n.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((e,n)=>{this.hasOwnProperty(n)&&(this._$Ei.set(n,this[n]),delete this[n])})}createRenderRoot(){var e;const n=(e=this.shadowRoot)!==null&&e!==void 0?e:this.attachShadow(this.constructor.shadowRootOptions);return xr(n,this.constructor.elementStyles),n}connectedCallback(){var e;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$ES)===null||e===void 0||e.forEach(n=>{var i;return(i=n.hostConnected)===null||i===void 0?void 0:i.call(n)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$ES)===null||e===void 0||e.forEach(n=>{var i;return(i=n.hostDisconnected)===null||i===void 0?void 0:i.call(n)})}attributeChangedCallback(e,n,i){this._$AK(e,i)}_$EO(e,n,i=xn){var o;const s=this.constructor._$Ep(e,i);if(s!==void 0&&i.reflect===!0){const r=(((o=i.converter)===null||o===void 0?void 0:o.toAttribute)!==void 0?i.converter:Kn).toAttribute(n,i.type);this._$El=e,r==null?this.removeAttribute(s):this.setAttribute(s,r),this._$El=null}}_$AK(e,n){var i;const o=this.constructor,s=o._$Ev.get(e);if(s!==void 0&&this._$El!==s){const r=o.getPropertyOptions(s),l=typeof r.converter=="function"?{fromAttribute:r.converter}:((i=r.converter)===null||i===void 0?void 0:i.fromAttribute)!==void 0?r.converter:Kn;this._$El=s,this[s]=l.fromAttribute(n,r.type),this._$El=null}}requestUpdate(e,n,i){let o=!0;e!==void 0&&(((i=i||this.constructor.getPropertyOptions(e)).hasChanged||go)(this[e],n)?(this._$AL.has(e)||this._$AL.set(e,n),i.reflect===!0&&this._$El!==e&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(e,i))):o=!1),!this.isUpdatePending&&o&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((o,s)=>this[s]=o),this._$Ei=void 0);let n=!1;const i=this._$AL;try{n=this.shouldUpdate(i),n?(this.willUpdate(i),(e=this._$ES)===null||e===void 0||e.forEach(o=>{var s;return(s=o.hostUpdate)===null||s===void 0?void 0:s.call(o)}),this.update(i)):this._$Ek()}catch(o){throw n=!1,this._$Ek(),o}n&&this._$AE(i)}willUpdate(e){}_$AE(e){var n;(n=this._$ES)===null||n===void 0||n.forEach(i=>{var o;return(o=i.hostUpdated)===null||o===void 0?void 0:o.call(i)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){this._$EC!==void 0&&(this._$EC.forEach((n,i)=>this._$EO(i,this[i],n)),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}};it[Vn]=!0,it.elementProperties=new Map,it.elementStyles=[],it.shadowRootOptions={mode:"open"},Si==null||Si({ReactiveElement:it}),((kn=nn.reactiveElementVersions)!==null&&kn!==void 0?kn:nn.reactiveElementVersions=[]).push("1.6.3");var Sn;const on=window,ut=on.trustedTypes,Ai=ut?ut.createPolicy("lit-html",{createHTML:t=>t}):void 0,sn="$lit$",Oe=`lit$${(Math.random()+"").slice(9)}$`,ei="?"+Oe,Ar=`<${ei}>`,Xe=document,Ct=()=>Xe.createComment(""),jt=t=>t===null||typeof t!="object"&&typeof t!="function",mo=Array.isArray,vo=t=>mo(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",An=`[ 	
\f\r]`,mt=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ei=/-->/g,Ci=/>/g,Ke=RegExp(`>|${An}(?:([^\\s"'>=/]+)(${An}*=${An}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),ji=/'/g,Pi=/"/g,yo=/^(?:script|style|textarea|title)$/i,Er=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),me=Er(1),$e=Symbol.for("lit-noChange"),se=Symbol.for("lit-nothing"),Oi=new WeakMap,Ge=Xe.createTreeWalker(Xe,129,null,!1);function _o(t,e){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Ai!==void 0?Ai.createHTML(e):e}const bo=(t,e)=>{const n=t.length-1,i=[];let o,s=e===2?"<svg>":"",r=mt;for(let l=0;l<n;l++){const a=t[l];let u,c,g=-1,p=0;for(;p<a.length&&(r.lastIndex=p,c=r.exec(a),c!==null);)p=r.lastIndex,r===mt?c[1]==="!--"?r=Ei:c[1]!==void 0?r=Ci:c[2]!==void 0?(yo.test(c[2])&&(o=RegExp("</"+c[2],"g")),r=Ke):c[3]!==void 0&&(r=Ke):r===Ke?c[0]===">"?(r=o??mt,g=-1):c[1]===void 0?g=-2:(g=r.lastIndex-c[2].length,u=c[1],r=c[3]===void 0?Ke:c[3]==='"'?Pi:ji):r===Pi||r===ji?r=Ke:r===Ei||r===Ci?r=mt:(r=Ke,o=void 0);const d=r===Ke&&t[l+1].startsWith("/>")?" ":"";s+=r===mt?a+Ar:g>=0?(i.push(u),a.slice(0,g)+sn+a.slice(g)+Oe+d):a+Oe+(g===-2?(i.push(void 0),l):d)}return[_o(t,s+(t[n]||"<?>")+(e===2?"</svg>":"")),i]};class Pt{constructor({strings:e,_$litType$:n},i){let o;this.parts=[];let s=0,r=0;const l=e.length-1,a=this.parts,[u,c]=bo(e,n);if(this.el=Pt.createElement(u,i),Ge.currentNode=this.el.content,n===2){const g=this.el.content,p=g.firstChild;p.remove(),g.append(...p.childNodes)}for(;(o=Ge.nextNode())!==null&&a.length<l;){if(o.nodeType===1){if(o.hasAttributes()){const g=[];for(const p of o.getAttributeNames())if(p.endsWith(sn)||p.startsWith(Oe)){const d=c[r++];if(g.push(p),d!==void 0){const f=o.getAttribute(d.toLowerCase()+sn).split(Oe),h=/([.?@])?(.*)/.exec(d);a.push({type:1,index:s,name:h[2],strings:f,ctor:h[1]==="."?wo:h[1]==="?"?ko:h[1]==="@"?xo:Tt})}else a.push({type:6,index:s})}for(const p of g)o.removeAttribute(p)}if(yo.test(o.tagName)){const g=o.textContent.split(Oe),p=g.length-1;if(p>0){o.textContent=ut?ut.emptyScript:"";for(let d=0;d<p;d++)o.append(g[d],Ct()),Ge.nextNode(),a.push({type:2,index:++s});o.append(g[p],Ct())}}}else if(o.nodeType===8)if(o.data===ei)a.push({type:2,index:s});else{let g=-1;for(;(g=o.data.indexOf(Oe,g+1))!==-1;)a.push({type:7,index:s}),g+=Oe.length-1}s++}}static createElement(e,n){const i=Xe.createElement("template");return i.innerHTML=e,i}}function Je(t,e,n=t,i){var o,s,r,l;if(e===$e)return e;let a=i!==void 0?(o=n._$Co)===null||o===void 0?void 0:o[i]:n._$Cl;const u=jt(e)?void 0:e._$litDirective$;return(a==null?void 0:a.constructor)!==u&&((s=a==null?void 0:a._$AO)===null||s===void 0||s.call(a,!1),u===void 0?a=void 0:(a=new u(t),a._$AT(t,n,i)),i!==void 0?((r=(l=n)._$Co)!==null&&r!==void 0?r:l._$Co=[])[i]=a:n._$Cl=a),a!==void 0&&(e=Je(t,a._$AS(t,e.values),a,i)),e}class $o{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var n;const{el:{content:i},parts:o}=this._$AD,s=((n=e==null?void 0:e.creationScope)!==null&&n!==void 0?n:Xe).importNode(i,!0);Ge.currentNode=s;let r=Ge.nextNode(),l=0,a=0,u=o[0];for(;u!==void 0;){if(l===u.index){let c;u.type===2?c=new ht(r,r.nextSibling,this,e):u.type===1?c=new u.ctor(r,u.name,u.strings,this,e):u.type===6&&(c=new So(r,this,e)),this._$AV.push(c),u=o[++a]}l!==(u==null?void 0:u.index)&&(r=Ge.nextNode(),l++)}return Ge.currentNode=Xe,s}v(e){let n=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,n),n+=i.strings.length-2):i._$AI(e[n])),n++}}class ht{constructor(e,n,i,o){var s;this.type=2,this._$AH=se,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=i,this.options=o,this._$Cp=(s=o==null?void 0:o.isConnected)===null||s===void 0||s}get _$AU(){var e,n;return(n=(e=this._$AM)===null||e===void 0?void 0:e._$AU)!==null&&n!==void 0?n:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=Je(this,e,n),jt(e)?e===se||e==null||e===""?(this._$AH!==se&&this._$AR(),this._$AH=se):e!==this._$AH&&e!==$e&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):vo(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==se&&jt(this._$AH)?this._$AA.nextSibling.data=e:this.$(Xe.createTextNode(e)),this._$AH=e}g(e){var n;const{values:i,_$litType$:o}=e,s=typeof o=="number"?this._$AC(e):(o.el===void 0&&(o.el=Pt.createElement(_o(o.h,o.h[0]),this.options)),o);if(((n=this._$AH)===null||n===void 0?void 0:n._$AD)===s)this._$AH.v(i);else{const r=new $o(s,this),l=r.u(this.options);r.v(i),this.$(l),this._$AH=r}}_$AC(e){let n=Oi.get(e.strings);return n===void 0&&Oi.set(e.strings,n=new Pt(e)),n}T(e){mo(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let i,o=0;for(const s of e)o===n.length?n.push(i=new ht(this.k(Ct()),this.k(Ct()),this,this.options)):i=n[o],i._$AI(s),o++;o<n.length&&(this._$AR(i&&i._$AB.nextSibling,o),n.length=o)}_$AR(e=this._$AA.nextSibling,n){var i;for((i=this._$AP)===null||i===void 0||i.call(this,!1,!0,n);e&&e!==this._$AB;){const o=e.nextSibling;e.remove(),e=o}}setConnected(e){var n;this._$AM===void 0&&(this._$Cp=e,(n=this._$AP)===null||n===void 0||n.call(this,e))}}class Tt{constructor(e,n,i,o,s){this.type=1,this._$AH=se,this._$AN=void 0,this.element=e,this.name=n,this._$AM=o,this.options=s,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=se}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,n=this,i,o){const s=this.strings;let r=!1;if(s===void 0)e=Je(this,e,n,0),r=!jt(e)||e!==this._$AH&&e!==$e,r&&(this._$AH=e);else{const l=e;let a,u;for(e=s[0],a=0;a<s.length-1;a++)u=Je(this,l[i+a],n,a),u===$e&&(u=this._$AH[a]),r||(r=!jt(u)||u!==this._$AH[a]),u===se?e=se:e!==se&&(e+=(u??"")+s[a+1]),this._$AH[a]=u}r&&!o&&this.j(e)}j(e){e===se?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class wo extends Tt{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===se?void 0:e}}const Cr=ut?ut.emptyScript:"";class ko extends Tt{constructor(){super(...arguments),this.type=4}j(e){e&&e!==se?this.element.setAttribute(this.name,Cr):this.element.removeAttribute(this.name)}}class xo extends Tt{constructor(e,n,i,o,s){super(e,n,i,o,s),this.type=5}_$AI(e,n=this){var i;if((e=(i=Je(this,e,n,0))!==null&&i!==void 0?i:se)===$e)return;const o=this._$AH,s=e===se&&o!==se||e.capture!==o.capture||e.once!==o.once||e.passive!==o.passive,r=e!==se&&(o===se||s);s&&this.element.removeEventListener(this.name,this,o),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var n,i;typeof this._$AH=="function"?this._$AH.call((i=(n=this.options)===null||n===void 0?void 0:n.host)!==null&&i!==void 0?i:this.element,e):this._$AH.handleEvent(e)}}class So{constructor(e,n,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){Je(this,e)}}const jr={O:sn,P:Oe,A:ei,C:1,M:bo,L:$o,R:vo,D:Je,I:ht,V:Tt,H:ko,N:xo,U:wo,F:So},Ii=on.litHtmlPolyfillSupport;Ii==null||Ii(Pt,ht),((Sn=on.litHtmlVersions)!==null&&Sn!==void 0?Sn:on.litHtmlVersions=[]).push("2.8.0");const Pr=(t,e,n)=>{var i,o;const s=(i=n==null?void 0:n.renderBefore)!==null&&i!==void 0?i:e;let r=s._$litPart$;if(r===void 0){const l=(o=n==null?void 0:n.renderBefore)!==null&&o!==void 0?o:null;s._$litPart$=r=new ht(e.insertBefore(Ct(),l),l,void 0,n??{})}return r._$AI(t),r};var En,Cn;let De=class extends it{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,n;const i=super.createRenderRoot();return(e=(n=this.renderOptions).renderBefore)!==null&&e!==void 0||(n.renderBefore=i.firstChild),i}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Pr(n,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)===null||e===void 0||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)===null||e===void 0||e.setConnected(!1)}render(){return $e}};De.finalized=!0,De._$litElement$=!0,(En=globalThis.litElementHydrateSupport)===null||En===void 0||En.call(globalThis,{LitElement:De});const Ti=globalThis.litElementPolyfillSupport;Ti==null||Ti({LitElement:De});((Cn=globalThis.litElementVersions)!==null&&Cn!==void 0?Cn:globalThis.litElementVersions=[]).push("3.3.3");const hn=t=>e=>typeof e=="function"?((n,i)=>(customElements.define(n,i),i))(t,e):((n,i)=>{const{kind:o,elements:s}=i;return{kind:o,elements:s,finisher(r){customElements.define(n,r)}}})(t,e);const Or=(t,e)=>e.kind==="method"&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(n){n.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){typeof e.initializer=="function"&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,t)}},Ir=(t,e,n)=>{e.constructor.createProperty(n,t)};function de(t){return(e,n)=>n!==void 0?Ir(t,e,n):Or(t,e)}function Fe(t){return de({...t,state:!0})}var jn;((jn=window.HTMLSlotElement)===null||jn===void 0?void 0:jn.prototype.assignedElements)!=null;const Ae={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Nt=t=>(...e)=>({_$litDirective$:t,values:e});class Lt{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,n,i){this._$Ct=e,this._$AM=n,this._$Ci=i}_$AS(e,n){return this.update(e,n)}update(e,n){return this.render(...n)}}const{I:Tr}=jr,Ao=t=>t.strings===void 0,Ni=()=>document.createComment(""),vt=(t,e,n)=>{var i;const o=t._$AA.parentNode,s=e===void 0?t._$AB:e._$AA;if(n===void 0){const r=o.insertBefore(Ni(),s),l=o.insertBefore(Ni(),s);n=new Tr(r,l,t,t.options)}else{const r=n._$AB.nextSibling,l=n._$AM,a=l!==t;if(a){let u;(i=n._$AQ)===null||i===void 0||i.call(n,t),n._$AM=t,n._$AP!==void 0&&(u=t._$AU)!==l._$AU&&n._$AP(u)}if(r!==s||a){let u=n._$AA;for(;u!==r;){const c=u.nextSibling;o.insertBefore(u,s),u=c}}}return n},Ve=(t,e,n=t)=>(t._$AI(e,n),t),Nr={},Eo=(t,e=Nr)=>t._$AH=e,Lr=t=>t._$AH,Pn=t=>{var e;(e=t._$AP)===null||e===void 0||e.call(t,!1,!0);let n=t._$AA;const i=t._$AB.nextSibling;for(;n!==i;){const o=n.nextSibling;n.remove(),n=o}};const Li=(t,e,n)=>{const i=new Map;for(let o=e;o<=n;o++)i.set(t[o],o);return i},Mr=Nt(class extends Lt{constructor(t){if(super(t),t.type!==Ae.CHILD)throw Error("repeat() can only be used in text expressions")}ct(t,e,n){let i;n===void 0?n=e:e!==void 0&&(i=e);const o=[],s=[];let r=0;for(const l of t)o[r]=i?i(l,r):r,s[r]=n(l,r),r++;return{values:s,keys:o}}render(t,e,n){return this.ct(t,e,n).values}update(t,[e,n,i]){var o;const s=Lr(t),{values:r,keys:l}=this.ct(e,n,i);if(!Array.isArray(s))return this.ut=l,r;const a=(o=this.ut)!==null&&o!==void 0?o:this.ut=[],u=[];let c,g,p=0,d=s.length-1,f=0,h=r.length-1;for(;p<=d&&f<=h;)if(s[p]===null)p++;else if(s[d]===null)d--;else if(a[p]===l[f])u[f]=Ve(s[p],r[f]),p++,f++;else if(a[d]===l[h])u[h]=Ve(s[d],r[h]),d--,h--;else if(a[p]===l[h])u[h]=Ve(s[p],r[h]),vt(t,u[h+1],s[p]),p++,h--;else if(a[d]===l[f])u[f]=Ve(s[d],r[f]),vt(t,s[p],s[d]),d--,f++;else if(c===void 0&&(c=Li(l,f,h),g=Li(a,p,d)),c.has(a[p]))if(c.has(a[d])){const y=g.get(l[f]),_=y!==void 0?s[y]:null;if(_===null){const A=vt(t,s[p]);Ve(A,r[f]),u[f]=A}else u[f]=Ve(_,r[f]),vt(t,s[p],_),s[y]=null;f++}else Pn(s[d]),d--;else Pn(s[p]),p++;for(;f<=h;){const y=vt(t,u[h+1]);Ve(y,r[f]),u[f++]=y}for(;p<=d;){const y=s[p++];y!==null&&Pn(y)}return this.ut=l,Eo(t,u),$e}});const Hr=Nt(class extends Lt{constructor(t){if(super(t),t.type!==Ae.PROPERTY&&t.type!==Ae.ATTRIBUTE&&t.type!==Ae.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!Ao(t))throw Error("`live` bindings can only contain a single expression")}render(t){return t}update(t,[e]){if(e===$e||e===se)return e;const n=t.element,i=t.name;if(t.type===Ae.PROPERTY){if(e===n[i])return $e}else if(t.type===Ae.BOOLEAN_ATTRIBUTE){if(!!e===n.hasAttribute(i))return $e}else if(t.type===Ae.ATTRIBUTE&&n.getAttribute(i)===e+"")return $e;return Eo(t),e}});const wt=(t,e)=>{var n,i;const o=t._$AN;if(o===void 0)return!1;for(const s of o)(i=(n=s)._$AO)===null||i===void 0||i.call(n,e,!1),wt(s,e);return!0},rn=t=>{let e,n;do{if((e=t._$AM)===void 0)break;n=e._$AN,n.delete(t),t=e}while((n==null?void 0:n.size)===0)},Co=t=>{for(let e;e=t._$AM;t=e){let n=e._$AN;if(n===void 0)e._$AN=n=new Set;else if(n.has(t))break;n.add(t),Dr(e)}};function Rr(t){this._$AN!==void 0?(rn(this),this._$AM=t,Co(this)):this._$AM=t}function zr(t,e=!1,n=0){const i=this._$AH,o=this._$AN;if(o!==void 0&&o.size!==0)if(e)if(Array.isArray(i))for(let s=n;s<i.length;s++)wt(i[s],!1),rn(i[s]);else i!=null&&(wt(i,!1),rn(i));else wt(this,t)}const Dr=t=>{var e,n,i,o;t.type==Ae.CHILD&&((e=(i=t)._$AP)!==null&&e!==void 0||(i._$AP=zr),(n=(o=t)._$AQ)!==null&&n!==void 0||(o._$AQ=Rr))};class Br extends Lt{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,n,i){super._$AT(e,n,i),Co(this),this.isConnected=e._$AU}_$AO(e,n=!0){var i,o;e!==this.isConnected&&(this.isConnected=e,e?(i=this.reconnected)===null||i===void 0||i.call(this):(o=this.disconnected)===null||o===void 0||o.call(this)),n&&(wt(this,e),rn(this))}setValue(e){if(Ao(this._$Ct))this._$Ct._$AI(e,this);else{const n=[...this._$Ct._$AH];n[this._$Ci]=e,this._$Ct._$AI(n,this,0)}}disconnected(){}reconnected(){}}const jo=()=>new Ur;let Ur=class{};const On=new WeakMap,Po=Nt(class extends Br{render(t){return se}update(t,[e]){var n;const i=e!==this.G;return i&&this.G!==void 0&&this.ot(void 0),(i||this.rt!==this.lt)&&(this.G=e,this.dt=(n=t.options)===null||n===void 0?void 0:n.host,this.ot(this.lt=t.element)),se}ot(t){var e;if(typeof this.G=="function"){const n=(e=this.dt)!==null&&e!==void 0?e:globalThis;let i=On.get(n);i===void 0&&(i=new WeakMap,On.set(n,i)),i.get(this.G)!==void 0&&this.G.call(this.dt,void 0),i.set(this.G,t),t!==void 0&&this.G.call(this.dt,t)}else this.G.value=t}get rt(){var t,e,n;return typeof this.G=="function"?(e=On.get((t=this.dt)!==null&&t!==void 0?t:globalThis))===null||e===void 0?void 0:e.get(this.G):(n=this.G)===null||n===void 0?void 0:n.value}disconnected(){this.rt===this.lt&&this.ot(void 0)}reconnected(){this.ot(this.lt)}});const Wn=Nt(class extends Lt{constructor(t){var e;if(super(t),t.type!==Ae.ATTRIBUTE||t.name!=="class"||((e=t.strings)===null||e===void 0?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){var n,i;if(this.it===void 0){this.it=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(s=>s!=="")));for(const s in e)e[s]&&!(!((n=this.nt)===null||n===void 0)&&n.has(s))&&this.it.add(s);return this.render(e)}const o=t.element.classList;this.it.forEach(s=>{s in e||(o.remove(s),this.it.delete(s))});for(const s in e){const r=!!e[s];r===this.it.has(s)||!((i=this.nt)===null||i===void 0)&&i.has(s)||(r?(o.add(s),this.it.add(s)):(o.remove(s),this.it.delete(s)))}return $e}});var Mt=function(t,e,n,i){var o=arguments.length,s=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let qe=class extends De{constructor(){super(...arguments),this.placeholder="",this.hideBreadcrumbs=!1,this.breadcrumbHome="Home",this.breadcrumbs=[],this._inputRef=jo()}render(){let e="";if(!this.hideBreadcrumbs){const n=[];for(const i of this.breadcrumbs)n.push(me`<button tabindex="-1" @click="${()=>this.selectParent(i)}" class="breadcrumb">${i}</button>`);e=me`<div class="breadcrumb-list"><button tabindex="-1" @click="${()=>this.selectParent()}" class="breadcrumb">${this.breadcrumbHome}</button> ${n}</div>`}return me`${e}<div part="ninja-input-wrapper" class="search-wrapper"><input part="ninja-input" type="text" id="search" spellcheck="false" autocomplete="off" @input="${this._handleInput}" ${Po(this._inputRef)} placeholder="${this.placeholder}" class="search"></div>`}setSearch(e){this._inputRef.value&&(this._inputRef.value.value=e)}focusSearch(){requestAnimationFrame(()=>this._inputRef.value.focus())}_handleInput(e){const n=e.target;this.dispatchEvent(new CustomEvent("change",{detail:{search:n.value},bubbles:!1,composed:!1}))}selectParent(e){this.dispatchEvent(new CustomEvent("setParent",{detail:{parent:e},bubbles:!0,composed:!0}))}firstUpdated(){this.focusSearch()}_close(){this.dispatchEvent(new CustomEvent("close",{bubbles:!0,composed:!0}))}};qe.styles=fn`:host{flex:1;position:relative}.search{padding:1.25em;flex-grow:1;flex-shrink:0;margin:0;border:none;appearance:none;font-size:1.125em;background:0 0;caret-color:var(--ninja-accent-color);color:var(--ninja-text-color);outline:0;font-family:var(--ninja-font-family)}.search::placeholder{color:var(--ninja-placeholder-color)}.breadcrumb-list{padding:1em 4em 0 1em;display:flex;flex-direction:row;align-items:stretch;justify-content:flex-start;flex:initial}.breadcrumb{background:var(--ninja-secondary-background-color);text-align:center;line-height:1.2em;border-radius:var(--ninja-key-border-radius);border:0;cursor:pointer;padding:.1em .5em;color:var(--ninja-secondary-text-color);margin-right:.5em;outline:0;font-family:var(--ninja-font-family)}.search-wrapper{display:flex;border-bottom:var(--ninja-separate-border)}`;Mt([de()],qe.prototype,"placeholder",void 0);Mt([de({type:Boolean})],qe.prototype,"hideBreadcrumbs",void 0);Mt([de()],qe.prototype,"breadcrumbHome",void 0);Mt([de({type:Array})],qe.prototype,"breadcrumbs",void 0);qe=Mt([hn("ninja-header")],qe);class Gn extends Lt{constructor(e){if(super(e),this.et=se,e.type!==Ae.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(e){if(e===se||e==null)return this.ft=void 0,this.et=e;if(e===$e)return e;if(typeof e!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(e===this.et)return this.ft;this.et=e;const n=[e];return n.raw=n,this.ft={_$litType$:this.constructor.resultType,strings:n,values:[]}}}Gn.directiveName="unsafeHTML",Gn.resultType=1;const Fr=Nt(Gn);function*Kr(t,e){const n=typeof e=="function";if(t!==void 0){let i=-1;for(const o of t)i>-1&&(yield n?e(i):e),i++,yield o}}function Vr(t,e,n,i){var o=arguments.length,s=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}const Wr=fn`:host{font-family:var(--mdc-icon-font, "Material Icons");font-weight:400;font-style:normal;font-size:var(--mdc-icon-size,24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}`;let Yn=class extends De{render(){return me`<span><slot></slot></span>`}};Yn.styles=[Wr];Yn=Vr([hn("mwc-icon")],Yn);var pn=function(t,e,n,i){var o=arguments.length,s=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let dt=class extends De{constructor(){super(),this.selected=!1,this.hotKeysJoinedView=!0,this.addEventListener("click",this.click)}ensureInView(){requestAnimationFrame(()=>this.scrollIntoView({block:"nearest"}))}click(){this.dispatchEvent(new CustomEvent("actionsSelected",{detail:this.action,bubbles:!0,composed:!0}))}updated(e){e.has("selected")&&this.selected&&this.ensureInView()}render(){let e;this.action.mdIcon?e=me`<mwc-icon part="ninja-icon" class="ninja-icon">${this.action.mdIcon}</mwc-icon>`:this.action.icon&&(e=Fr(this.action.icon||""));let n;this.action.hotkey&&(this.hotKeysJoinedView?n=this.action.hotkey.split(",").map(o=>{const s=o.split("+"),r=me`${Kr(s.map(l=>me`<kbd>${l}</kbd>`),"+")}`;return me`<div class="ninja-hotkey ninja-hotkeys">${r}</div>`}):n=this.action.hotkey.split(",").map(o=>{const r=o.split("+").map(l=>me`<kbd class="ninja-hotkey">${l}</kbd>`);return me`<kbd class="ninja-hotkeys">${r}</kbd>`}));const i={selected:this.selected,"ninja-action":!0};return me`<div class="ninja-action" part="ninja-action ${this.selected?"ninja-selected":""}" class="${Wn(i)}">${e}<div class="ninja-title">${this.action.title}</div>${n}</div>`}};dt.styles=fn`:host{display:flex;width:100%}.ninja-action{padding:.75em 1em;display:flex;border-left:2px solid transparent;align-items:center;justify-content:start;outline:0;transition:color 0s ease 0s;width:100%}.ninja-action.selected{cursor:pointer;color:var(--ninja-selected-text-color);background-color:var(--ninja-selected-background);border-left:2px solid var(--ninja-accent-color);outline:0}.ninja-action.selected .ninja-icon{color:var(--ninja-selected-text-color)}.ninja-icon{font-size:var(--ninja-icon-size);max-width:var(--ninja-icon-size);max-height:var(--ninja-icon-size);margin-right:1em;color:var(--ninja-icon-color);margin-right:1em;position:relative}.ninja-title{flex-shrink:.01;margin-right:.5em;flex-grow:1;font-size:.8125em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ninja-hotkeys{flex-shrink:0;width:min-content;display:flex}.ninja-hotkeys kbd{font-family:inherit}.ninja-hotkey{background:var(--ninja-secondary-background-color);padding:.06em .25em;border-radius:var(--ninja-key-border-radius);text-transform:capitalize;color:var(--ninja-secondary-text-color);font-size:.75em;font-family:inherit}.ninja-hotkey+.ninja-hotkey{margin-left:.5em}.ninja-hotkeys+.ninja-hotkeys{margin-left:1em}`;pn([de({type:Object})],dt.prototype,"action",void 0);pn([de({type:Boolean})],dt.prototype,"selected",void 0);pn([de({type:Boolean})],dt.prototype,"hotKeysJoinedView",void 0);dt=pn([hn("ninja-action")],dt);const Gr=me`<div class="modal-footer" slot="footer"><span class="help"><svg version="1.0" class="ninja-examplekey" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1280 1280"><path d="M1013 376c0 73.4-.4 113.3-1.1 120.2a159.9 159.9 0 0 1-90.2 127.3c-20 9.6-36.7 14-59.2 15.5-7.1.5-121.9.9-255 1h-242l95.5-95.5 95.5-95.5-38.3-38.2-38.2-38.3-160 160c-88 88-160 160.4-160 161 0 .6 72 73 160 161l160 160 38.2-38.3 38.3-38.2-95.5-95.5-95.5-95.5h251.1c252.9 0 259.8-.1 281.4-3.6 72.1-11.8 136.9-54.1 178.5-116.4 8.6-12.9 22.6-40.5 28-55.4 4.4-12 10.7-36.1 13.1-50.6 1.6-9.6 1.8-21 2.1-132.8l.4-122.2H1013v110z"/></svg> to select </span><span class="help"><svg xmlns="http://www.w3.org/2000/svg" class="ninja-examplekey" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"/></svg> <svg xmlns="http://www.w3.org/2000/svg" class="ninja-examplekey" viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"/></svg> to navigate </span><span class="help"><span class="ninja-examplekey esc">esc</span> to close </span><span class="help"><svg xmlns="http://www.w3.org/2000/svg" class="ninja-examplekey backspace" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6.707 4.879A3 3 0 018.828 4H15a3 3 0 013 3v6a3 3 0 01-3 3H8.828a3 3 0 01-2.12-.879l-4.415-4.414a1 1 0 010-1.414l4.414-4.414zm4 2.414a1 1 0 00-1.414 1.414L10.586 10l-1.293 1.293a1 1 0 101.414 1.414L12 11.414l1.293 1.293a1 1 0 001.414-1.414L13.414 10l1.293-1.293a1 1 0 00-1.414-1.414L12 8.586l-1.293-1.293z" clip-rule="evenodd"/></svg> move to parent</span></div>`,Yr=fn`:host{--ninja-width:640px;--ninja-backdrop-filter:none;--ninja-overflow-background:rgba(255, 255, 255, 0.5);--ninja-text-color:rgb(60, 65, 73);--ninja-font-size:16px;--ninja-top:20%;--ninja-key-border-radius:0.25em;--ninja-accent-color:rgb(110, 94, 210);--ninja-secondary-background-color:rgb(239, 241, 244);--ninja-secondary-text-color:rgb(107, 111, 118);--ninja-selected-background:rgb(248, 249, 251);--ninja-icon-color:var(--ninja-secondary-text-color);--ninja-icon-size:1.2em;--ninja-separate-border:1px solid var(--ninja-secondary-background-color);--ninja-modal-background:#fff;--ninja-modal-shadow:rgb(0 0 0 / 50%) 0px 16px 70px;--ninja-actions-height:300px;--ninja-group-text-color:rgb(144, 149, 157);--ninja-footer-background:rgba(242, 242, 242, 0.4);--ninja-placeholder-color:#8e8e8e;font-size:var(--ninja-font-size);--ninja-z-index:1}:host(.dark){--ninja-backdrop-filter:none;--ninja-overflow-background:rgba(0, 0, 0, 0.7);--ninja-text-color:#7d7d7d;--ninja-modal-background:rgba(17, 17, 17, 0.85);--ninja-accent-color:rgb(110, 94, 210);--ninja-secondary-background-color:rgba(51, 51, 51, 0.44);--ninja-secondary-text-color:#888;--ninja-selected-text-color:#eaeaea;--ninja-selected-background:rgba(51, 51, 51, 0.44);--ninja-icon-color:var(--ninja-secondary-text-color);--ninja-separate-border:1px solid var(--ninja-secondary-background-color);--ninja-modal-shadow:0 16px 70px rgba(0, 0, 0, 0.2);--ninja-group-text-color:rgb(144, 149, 157);--ninja-footer-background:rgba(30, 30, 30, 85%)}.modal{display:none;position:fixed;z-index:var(--ninja-z-index);left:0;top:0;width:100%;height:100%;overflow:auto;background:var(--ninja-overflow-background);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-backdrop-filter:var(--ninja-backdrop-filter);backdrop-filter:var(--ninja-backdrop-filter);text-align:left;color:var(--ninja-text-color);font-family:var(--ninja-font-family)}.modal.visible{display:block}.modal-content{position:relative;top:var(--ninja-top);margin:auto;padding:0;display:flex;flex-direction:column;flex-shrink:1;-webkit-box-flex:1;flex-grow:1;min-width:0;will-change:transform;background:var(--ninja-modal-background);border-radius:.5em;box-shadow:var(--ninja-modal-shadow);max-width:var(--ninja-width);overflow:hidden}.bump{animation:zoom-in-zoom-out .2s ease}@keyframes zoom-in-zoom-out{0%{transform:scale(.99)}50%{transform:scale(1.01,1.01)}100%{transform:scale(1,1)}}.ninja-github{color:var(--ninja-keys-text-color);font-weight:400;text-decoration:none}.actions-list{max-height:var(--ninja-actions-height);overflow:auto;scroll-behavior:smooth;position:relative;margin:0;padding:.5em 0;list-style:none;scroll-behavior:smooth}.group-header{height:1.375em;line-height:1.375em;padding-left:1.25em;padding-top:.5em;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;font-size:.75em;line-height:1em;color:var(--ninja-group-text-color);margin:1px 0}.modal-footer{background:var(--ninja-footer-background);padding:.5em 1em;display:flex;border-top:var(--ninja-separate-border);color:var(--ninja-secondary-text-color)}.modal-footer .help{display:flex;margin-right:1em;align-items:center;font-size:.75em}.ninja-examplekey{background:var(--ninja-secondary-background-color);padding:.06em .25em;border-radius:var(--ninja-key-border-radius);color:var(--ninja-secondary-text-color);width:1em;height:1em;margin-right:.5em;font-size:1.25em;fill:currentColor}.ninja-examplekey.esc{width:auto;height:auto;font-size:1.1em}.ninja-examplekey.backspace{opacity:.7}`;var ue=function(t,e,n,i){var o=arguments.length,s=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};let le=class extends De{constructor(){super(...arguments),this.placeholder="Type a command or search...",this.disableHotkeys=!1,this.hideBreadcrumbs=!1,this.openHotkey="cmd+k,ctrl+k",this.navigationUpHotkey="up,shift+tab",this.navigationDownHotkey="down,tab",this.closeHotkey="esc",this.goBackHotkey="backspace",this.selectHotkey="enter",this.hotKeysJoinedView=!1,this.noAutoLoadMdIcons=!1,this.data=[],this.visible=!1,this._bump=!0,this._actionMatches=[],this._search="",this._flatData=[],this._headerRef=jo()}open(e={}){this._bump=!0,this.visible=!0,this._headerRef.value.focusSearch(),this._actionMatches.length>0&&(this._selected=this._actionMatches[0]),this.setParent(e.parent)}close(){this._bump=!1,this.visible=!1}setParent(e){e?this._currentRoot=e:this._currentRoot=void 0,this._selected=void 0,this._search="",this._headerRef.value.setSearch("")}get breadcrumbs(){var e;const n=[];let i=(e=this._selected)===null||e===void 0?void 0:e.parent;if(i)for(n.push(i);i;){const o=this._flatData.find(s=>s.id===i);o!=null&&o.parent&&n.push(o.parent),i=o?o.parent:void 0}return n.reverse()}connectedCallback(){super.connectedCallback(),this.noAutoLoadMdIcons||document.fonts.load("24px Material Icons","apps").then(()=>{}),this._registerInternalHotkeys()}disconnectedCallback(){super.disconnectedCallback(),this._unregisterInternalHotkeys()}_flattern(e,n){let i=[];return e||(e=[]),e.map(o=>{const s=o.children&&o.children.some(l=>typeof l=="string"),r={...o,parent:o.parent||n};return s||(r.children&&r.children.length&&(n=o.id,i=[...i,...r.children]),r.children=r.children?r.children.map(l=>l.id):[]),r}).concat(i.length?this._flattern(i,n):i)}update(e){e.has("data")&&!this.disableHotkeys&&(this._flatData=this._flattern(this.data),this._flatData.filter(n=>!!n.hotkey).forEach(n=>{ie(n.hotkey,i=>{i.preventDefault(),n.handler&&n.handler(n)})})),super.update(e)}_registerInternalHotkeys(){this.openHotkey&&ie(this.openHotkey,e=>{e.preventDefault(),this.visible?this.close():this.open()}),this.selectHotkey&&ie(this.selectHotkey,e=>{this.visible&&(e.preventDefault(),this._actionSelected(this._actionMatches[this._selectedIndex]))}),this.goBackHotkey&&ie(this.goBackHotkey,e=>{this.visible&&(this._search||(e.preventDefault(),this._goBack()))}),this.navigationDownHotkey&&ie(this.navigationDownHotkey,e=>{this.visible&&(e.preventDefault(),this._selectedIndex>=this._actionMatches.length-1?this._selected=this._actionMatches[0]:this._selected=this._actionMatches[this._selectedIndex+1])}),this.navigationUpHotkey&&ie(this.navigationUpHotkey,e=>{this.visible&&(e.preventDefault(),this._selectedIndex===0?this._selected=this._actionMatches[this._actionMatches.length-1]:this._selected=this._actionMatches[this._selectedIndex-1])}),this.closeHotkey&&ie(this.closeHotkey,()=>{this.visible&&this.close()})}_unregisterInternalHotkeys(){this.openHotkey&&ie.unbind(this.openHotkey),this.selectHotkey&&ie.unbind(this.selectHotkey),this.goBackHotkey&&ie.unbind(this.goBackHotkey),this.navigationDownHotkey&&ie.unbind(this.navigationDownHotkey),this.navigationUpHotkey&&ie.unbind(this.navigationUpHotkey),this.closeHotkey&&ie.unbind(this.closeHotkey)}_actionFocused(e,n){this._selected=e,n.target.ensureInView()}_onTransitionEnd(){this._bump=!1}_goBack(){const e=this.breadcrumbs.length>1?this.breadcrumbs[this.breadcrumbs.length-2]:void 0;this.setParent(e)}render(){const e={bump:this._bump,"modal-content":!0},n={visible:this.visible,modal:!0},o=this._flatData.filter(l=>{var a;const u=new RegExp(this._search,"gi"),c=l.title.match(u)||((a=l.keywords)===null||a===void 0?void 0:a.match(u));return(!this._currentRoot&&this._search||l.parent===this._currentRoot)&&c}).reduce((l,a)=>l.set(a.section,[...l.get(a.section)||[],a]),new Map);this._actionMatches=[...o.values()].flat(),this._actionMatches.length>0&&this._selectedIndex===-1&&(this._selected=this._actionMatches[0]),this._actionMatches.length===0&&(this._selected=void 0);const s=l=>me`${Mr(l,a=>a.id,a=>{var u;return me`<ninja-action exportparts="ninja-action,ninja-selected,ninja-icon" .selected="${Hr(a.id===((u=this._selected)===null||u===void 0?void 0:u.id))}" .hotKeysJoinedView="${this.hotKeysJoinedView}" @mouseover="${c=>this._actionFocused(a,c)}" @actionsSelected="${c=>this._actionSelected(c.detail)}" .action="${a}"></ninja-action>`})}`,r=[];return o.forEach((l,a)=>{const u=a?me`<div class="group-header">${a}</div>`:void 0;r.push(me`${u}${s(l)}`)}),me`<div @click="${this._overlayClick}" class="${Wn(n)}"><div class="${Wn(e)}" @animationend="${this._onTransitionEnd}"><ninja-header exportparts="ninja-input,ninja-input-wrapper" ${Po(this._headerRef)} .placeholder="${this.placeholder}" .hideBreadcrumbs="${this.hideBreadcrumbs}" .breadcrumbs="${this.breadcrumbs}" @change="${this._handleInput}" @setParent="${l=>this.setParent(l.detail.parent)}" @close="${this.close}"></ninja-header><div class="modal-body"><div class="actions-list" part="actions-list">${r}</div></div><slot name="footer">${Gr}</slot></div></div>`}get _selectedIndex(){return this._selected?this._actionMatches.indexOf(this._selected):-1}_actionSelected(e){var n;if(this.dispatchEvent(new CustomEvent("selected",{detail:{search:this._search,action:e},bubbles:!0,composed:!0})),!!e){if(e.children&&((n=e.children)===null||n===void 0?void 0:n.length)>0&&(this._currentRoot=e.id,this._search=""),this._headerRef.value.setSearch(""),this._headerRef.value.focusSearch(),e.handler){const i=e.handler(e);i!=null&&i.keepOpen||this.close()}this._bump=!0}}async _handleInput(e){this._search=e.detail.search,await this.updateComplete,this.dispatchEvent(new CustomEvent("change",{detail:{search:this._search,actions:this._actionMatches},bubbles:!0,composed:!0}))}_overlayClick(e){var n;!((n=e.target)===null||n===void 0)&&n.classList.contains("modal")&&this.close()}};le.styles=[Yr];ue([de({type:String})],le.prototype,"placeholder",void 0);ue([de({type:Boolean})],le.prototype,"disableHotkeys",void 0);ue([de({type:Boolean})],le.prototype,"hideBreadcrumbs",void 0);ue([de()],le.prototype,"openHotkey",void 0);ue([de()],le.prototype,"navigationUpHotkey",void 0);ue([de()],le.prototype,"navigationDownHotkey",void 0);ue([de()],le.prototype,"closeHotkey",void 0);ue([de()],le.prototype,"goBackHotkey",void 0);ue([de()],le.prototype,"selectHotkey",void 0);ue([de({type:Boolean})],le.prototype,"hotKeysJoinedView",void 0);ue([de({type:Boolean})],le.prototype,"noAutoLoadMdIcons",void 0);ue([de({type:Array,hasChanged(){return!0}})],le.prototype,"data",void 0);ue([Fe()],le.prototype,"visible",void 0);ue([Fe()],le.prototype,"_bump",void 0);ue([Fe()],le.prototype,"_actionMatches",void 0);ue([Fe()],le.prototype,"_search",void 0);ue([Fe()],le.prototype,"_currentRoot",void 0);ue([Fe()],le.prototype,"_flatData",void 0);ue([Fe()],le.prototype,"breadcrumbs",null);ue([Fe()],le.prototype,"_selected",void 0);le=ue([hn("ninja-keys")],le);var Xr=Y("<ninja-keys>",!0,!1);const Jr=t=>(()=>{var e=Xr();return e._$owner=Fo(),X(n=>{var i=t.hotkeys,o=t.placeholder,s=t.disableHotkeys,r=t.hideBreadcrumbs,l=t.openHotkey,a=t.navigationUpHotkey,u=t.navigationDownHotkey,c=t.closeHotkey,g=t.goBackHotkey,p=t.selectHotkey,d=t.hotKeysJoinedView,f=t.noAutoLoadMdIcons,h=t.isDark?"dark":"light";return i!==n.e&&(e.data=n.e=i),o!==n.t&&(e.placeholder=n.t=o),s!==n.a&&(e.disablehotkeys=n.a=s),r!==n.o&&(e.hidebreadcrumbs=n.o=r),l!==n.i&&(e.openhotkey=n.i=l),a!==n.n&&(e.navigationuphotkey=n.n=a),u!==n.s&&(e.navigationdownhotkey=n.s=u),c!==n.h&&(e.closehotkey=n.h=c),g!==n.r&&(e.gobackhotkey=n.r=g),p!==n.d&&(e.selecthotkey=n.d=p),d!==n.l&&(e.hotkeysjoinedview=n.l=d),f!==n.u&&(e.noautoloadmdicons=n.u=f),h!==n.c&&ts(e,n.c=h),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),e})(),qr=Jr;function Zr(){let t;return st(()=>{t=document.querySelector("ninja-keys")}),{open:o=>{t==null||t.open(o?{parent:o}:void 0)},close:()=>{t==null||t.close()},setParent:o=>{t==null||t.setParent(o)}}}var Qr=Y("<div class=helpPopup><div class=close>‚ùå</div><div class=header>Help</div><div class=modalContent><div class=help><div class=info><div class=title></div><div class=text></div></div></div><ul class=menu>"),el=Y("<video class=video>"),tl=Y("<li class=help>");const nl=t=>{const[e,n]=Z(0),i=[...["Tweak prompts","Temporarily disable phrases","Tweak variables","Hotkey change numerical values","Prompt weights","Pin images","Assign to variables","Convert links easily","Align blocks","Shift drag for quick access","Show links between","Jump between sibling nodes","Jump to assigment","Search for node names and jump","Batch rename variables","Help section","How to get started"].map(s=>({name:s,video:"https://im.ma.pe/20bfea638130d57040802b6f011dcdd5.mp4",text:`You can access ${s} by clicking the menu in the top right.`}))],o=()=>i[e()];return(()=>{var s=Qr(),r=s.firstChild,l=r.nextSibling,a=l.nextSibling,u=a.firstChild,c=u.firstChild,g=c.firstChild,p=g.nextSibling,d=u.nextSibling;return Jn(r,"click",t.close,!0),K(u,(()=>{var f=oe(()=>!!o().video);return()=>f()?(()=>{var h=el();return h.muted=!0,h.autoplay=!0,h.controls=!0,X(()=>pe(h,"src",o().video)),h})():null})(),c),K(g,()=>o().name),K(p,()=>o().text),K(d,()=>i.map((f,h)=>(()=>{var y=tl();return y.$$click=()=>{n(h)},K(y,()=>f.name),X(()=>y.classList.toggle("active",h===e())),y})())),s})()};Ze(["click"]);var il=Y("<div class=mapeConfirmPrompt><div class=title></div><input type=text><div class=suggestions>"),ol=Y("<div class=suggestion>");const sl=({title:t,position:e,callback:n,exit:i,fallback:o})=>{const[s,r]=Z(-1);let l,a;st(()=>{a.focus(),a.select()});const[u,c]=Z(""),[g]=Z(Os(Zi().map(h=>q(h,0)))),p=h=>{_s(l,h.target)||i()},d=h=>{if(h.key==="ArrowUp"||h.key==="ArrowDown"){h.preventDefault(),h.key==="ArrowUp"&&r(s()-1),h.key==="ArrowDown"&&r(s()+1),s()<0&&r(0),s()>g().length-1&&r(g().length-1),a.select();return}if(h.key==="Enter"){s()!==-1&&c(g().filter(f)[s()]),n((u()||o)??"");return}if(h.key==="Escape"){i();return}r(-1)};st(()=>{document.body.addEventListener("click",p),document.body.addEventListener("keyup",d)}),xt(()=>{document.body.removeEventListener("click",p),document.body.removeEventListener("keyup",d)});const f=h=>(console.log("inputValue()",u()),u().trim()===""?!0:h.match(new RegExp(u(),"i")));return(()=>{var h=il(),y=h.firstChild,_=y.nextSibling,A=_.nextSibling,b=l;typeof b=="function"?_t(b,h):l=h,K(y,t),_.$$keyup=j=>{j.key!=="Shift"&&c(j.currentTarget.value)};var x=a;return typeof x=="function"?_t(x,_):a=_,pe(_,"placeholder",o),K(A,()=>g().filter(f).map((j,I)=>(()=>{var B=ol();return B.$$click=()=>{n(j)},K(B,j),X(()=>B.classList.toggle("selected",s()===I)),B})())),X(j=>{var I=`${e.x}px`,B=`${e.y}px`;return I!==j.e&&((j.e=I)!=null?h.style.setProperty("left",I):h.style.removeProperty("left")),B!==j.t&&((j.t=B)!=null?h.style.setProperty("top",B):h.style.removeProperty("top")),j},{e:void 0,t:void 0}),X(()=>_.value=u()),h})()};Ze(["keyup","click"]);var rl=Y("<div class=warningsPopup><div class=close>‚ùå</div><div class=header>Warnings</div><div class=modalContent><div class=mapeSettings>"),ll=Y("<div class=mapeSetting><label class=name><small></small></label><button>Jump to node");const al=t=>(()=>{var e=rl(),n=e.firstChild,i=n.nextSibling,o=i.nextSibling,s=o.firstChild;return Jn(n,"click",t.close,!0),K(s,()=>t.warnings.map(r=>(()=>{var l=ll(),a=l.firstChild,u=a.firstChild,c=a.nextSibling;return K(a,(()=>{var g=oe(()=>!!he(r.node));return()=>{var p,d;return g()?q(r.node):`${((p=r.node)==null?void 0:p.title)??((d=r.node)==null?void 0:d.type)}: ${r.type}`}})(),u),K(u,()=>r.text),c.$$click=()=>{at(r.node)},l})())),e})();Ze(["click"]);var cl=Y('<div class="tweak numberWrapper"><label></label><div class=value><input type=number step=1>'),ul=Y('<div class="tweak numberWrapper"><label></label><div class=value><input type=number step=0.1>'),dl=Y('<div class="tweak stringContainer"><label class=interactable></label><div class=value>'),fl=Y("<textarea>"),hl=Y("<input type=text>"),pl=Y('<div class="tweak imageContainer"><label>'),gl=Y("<div class=thumbnails>"),ml=Y("<img class=fullImage>"),vl=Y("<div class=thumb><img class=smallImage>"),yl=Y("<div class=missing>"),_l=Y("<div class=value>"),bl=Y("<div class=missingImage>?"),$l=Y("<div class=image>"),wl=Y('<div class="tweak defaultContainer"><label>'),kl=Y('<div class=mapeRoot><div class=mapeBar><div class=logo title=https://twitter.com/mape></div><div class=tweaks></div><div class=options><div class=imagePreview title="Open separate window for image previews">üñ•Ô∏è<small>üé®</small></div><div class=clear title="Clear favourites">‚ùå</div><div class=settings title=Settings>‚öôÔ∏è</div></div></div><div>'),xl=Y("<div class=tweakHighlight>"),Sl=Y('<div class="warnings blink"title="Show potentially broken nodes">‚ö†Ô∏è');const Al=()=>{const[t,e]=Z([]),[n,i]=en({}),[o,s]=en({}),[r,l]=Z([]),[a,u]=Z(!1),[c,g]=Z(!1),[p,d]=Z(!1),f=()=>{const m=[],v={},w=ze().filter(he);for(const P of w.filter(_e)){const C=q(P);v[C]||(v[C]=0),v[C]+=1;const O=Ps(P);if(O&&he(O)){const T=q(O);C===T&&m.push({node:P,text:"Can't point a set to a get of itself"})}}for(const P of w.filter(lt)){const C=q(P);C&&typeof v[C]>"u"&&m.push({node:P,text:"Missing set node"})}for(const P of w.filter(_e)){const C=q(P);v[C]&&v[C]>1&&m.push({text:"Can't have multiple set nodes of the same name",node:P})}l([...window.mapeErrors??[],...m])};Se(()=>{r().length===0&&d(!1)});const h=setInterval(f,1e3);xt(()=>{clearInterval(h)});const y=()=>{i(Rn(Object.fromEntries(Object.entries(localStorage).filter(([m])=>m.startsWith(Ht)).map(([m,v])=>{const w=m.replace(Ht,""),[P,C,O]=js(w),T=xe(O);if(!T)return null;const L=T!=null&&T.pos?[T==null?void 0:T.pos[0],T==null?void 0:T.pos[1]]:[Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER];return[w,{name:w,type:v,value:P,pos:L}]}).filter(Boolean)))),localStorage[bt]=JSON.stringify(Object.fromEntries(Object.entries(n).filter(([,m])=>m.type==="IMAGE")))};st(y),window.addEventListener("mapeTweak",y);const _=m=>{const v=(m??0).toString().length*6+35;return`${Math.max(55,v)}px`},A={INT:m=>(()=>{var v=cl(),w=v.firstChild,P=w.nextSibling,C=P.firstChild;return v.addEventListener("wheel",O=>{const T=O.deltaY>0?-1:1;Me(m.name,L=>L+T)}),v.$$click=O=>{if(O.shiftKey)return pt(m.name)},K(w,()=>m.name),C.$$input=O=>{const T=parseInt(O.currentTarget.value,10);i(m.name,"value",T),Me(m.name,T)},X(()=>_(m.value)!=null?P.style.setProperty("width",_(m.value)):P.style.removeProperty("width")),X(()=>C.value=m.value),v})(),FLOAT:m=>{const v=w=>typeof w<"u"?parseFloat(parseFloat(w.toString()).toFixed(3)):0;return(()=>{var w=ul(),P=w.firstChild,C=P.nextSibling,O=C.firstChild;return w.addEventListener("wheel",T=>{const L=T.deltaY>0?-.1:.1;Me(m.name,m.value+L)}),w.$$click=T=>{if(T.shiftKey)return pt(m.name)},K(P,()=>m.name),O.$$input=T=>{const L=parseFloat(T.currentTarget.value);i(m.name,"value",L),Me(m.name,L)},X(()=>_(v(m.value))!=null?C.style.setProperty("width",_(v(m.value))):C.style.removeProperty("width")),X(()=>O.value=v(m.value)),w})()},STRING:m=>{const[v,w]=Z(o[m.name]??!1),P=C=>{const O=C.currentTarget.value;i(m.name,"value",O),Me(m.name,O)};return(()=>{var C=dl(),O=C.firstChild,T=O.nextSibling;return O.$$click=L=>{if(L.shiftKey)return pt(m.name);w(!v())},K(O,()=>m.name),K(T,(()=>{var L=oe(()=>!!v());return()=>L()?[(()=>{var k=fl();return k.$$input=P,X(()=>k.value=m.value),k})(),fe(cr,{get prompt(){return m.value},update:k=>{Me(m.name,k)}})]:(()=>{var k=hl();return k.$$input=P,k.addEventListener("focus",()=>{w(!0)}),X(()=>k.value=m.value),k})()})()),X(()=>C.classList.toggle("focused",!!v())),C})()},IMAGE:m=>{const[v,w]=Z(!1),[P,C]=Z(0);Se(()=>{const k=document.querySelector(".comfy-menu");k&&(v()?k.style.display="none":k.style.display="block")});const O=()=>`mape_tweak_image_cache_${m.name}`;Se(()=>{m.value&&(sessionStorage[O()]=JSON.stringify(m.value))});const T=()=>`Connect "${m.name}" variable to a Preview Image node or Regenerate the image`,L=()=>m.value??(sessionStorage[O()]?JSON.parse(sessionStorage[O()]):void 0);return(()=>{var k=pl(),W=k.firstChild;return k.$$click=z=>{if(z.shiftKey)return pt(m.name);z.target.tagName==="IMG"||z.target.className==="thumbnails"||z.target.className==="thumb"||(w(!v()),v()||C(0))},K(W,()=>m.name),K(k,(()=>{var z=oe(()=>!!v());return()=>z()?(()=>{var G=oe(()=>!!L());return()=>G()?[(()=>{var D=gl();return K(D,()=>(L()??[]).map((J,Q)=>(()=>{var ae=vl(),ye=ae.firstChild;return ae.$$click=()=>{C(Q)},X(()=>pe(ye,"src",Re(J))),ae})())),D})(),(()=>{var D=ml();return X(()=>{var J;return pe(D,"src",Re((J=L())==null?void 0:J[P()]))}),D})()]:(()=>{var D=yl();return K(D,T),D})()})():(()=>{var G=_l();return K(G,(()=>{var D=oe(()=>!!L());return()=>D()?"":(()=>{var J=bl();return X(()=>pe(J,"title",T())),J})()})(),null),K(G,()=>(L()??[]).map(D=>{const J=`url("${Re(D)}")`;return(()=>{var Q=$l();return J!=null?Q.style.setProperty("background-image",J):Q.style.removeProperty("background-image"),Q})()}),null),G})()})(),null),X(z=>{var G=!!v(),D=(L()??[]).length>1;return G!==z.e&&k.classList.toggle("focused",z.e=G),D!==z.t&&k.classList.toggle("hasMultiple",z.t=D),z},{e:void 0,t:void 0}),k})()},DEFAULT:m=>(()=>{var v=wl(),w=v.firstChild;return v.$$click=P=>{if(P.shiftKey)return pt(m.name)},K(w,()=>m.name),X(()=>pe(v,"title",JSON.stringify(m,null,"  "))),v})()},[b,x]=Z([]),{open:j}=Zr();st(()=>{const m=document.querySelector("ninja-keys");m&&m.shadowRoot.appendChild(bs(`
			* {
				will-change: unset !important;
				&::-webkit-scrollbar {
					width: 5px;
					height: 5px;
					background: linear-gradient(to right, #111, #222);
				}
				&::-webkit-scrollbar-thumb {
					background: linear-gradient(to bottom, #fff, #aaa);
					border: 1px solid #fff;
					border-radius: 10px;
				}
			}
			`))});const I=m=>{if(m.key==="P"&&m.shiftKey){if(vn())return;j(),x([...ze().filter(v=>{var w,P;return v.type!=="mape Variable"||v.type==="mape Variable"&&((P=(w=v.inputs)==null?void 0:w[0])==null?void 0:P.type)!=="*"}).map(v=>v.type==="mape Variable"?{id:v.id,title:`Jump to variable: ${q(v)??v.title??v.type} (${v.id})`,mdIcon:"timeline",handler:()=>{hi(v.id)}}:{id:v.id,title:`Jump to node: ${v.title??v.type} (${v.id}) ${v.widgets_values&&Array.isArray(v.widgets_values)?` - ${v.widgets_values.join(", ")}`:""}`.slice(0,90),mdIcon:"circle",handler:()=>{hi(v.id)}}),...Qi().map(v=>({title:`Jump to group: ${v.title}`,mdIcon:"workspaces",handler:()=>{Ss(v.title)}}))])}},B=[],[M,F]=Z({1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1}),S=m=>Object.fromEntries(Object.keys(M()).map((v,w)=>[v,m===w]));st(()=>{document.body.addEventListener("keydown",I);for(const m of[1,2,3,4,5,6,7,8,9])for(const v of["up","down"]){const w=`${m}+${v}`;ie(w,()=>{if(vn())return;const P=V()[m-1];if(!P)return;const C=P.type;if(C==="INT"){const O=v==="up"?1:-1;Me(P.name,P.value+O)}if(C==="FLOAT"){const O=v==="up"?.1:-.1;Me(P.name,P.value+O)}}),B.push(()=>{ie.unbind(w)})}});const $=m=>{if(vn())return;const v=m.key.match(/^\d+$/);if(v){const w=V()[parseInt(v[0],10)-1];if(!w)return;w.type==="STRING"?s(w.name,!o[w.name]):F(S(parseFloat(m.key)-1))}},N=m=>{m.key.match(/^\d+$/)&&F(S(-1))};document.body.addEventListener("keypress",$),document.body.addEventListener("keyup",N),xt(()=>{document.body.addEventListener("keydown",I);for(const m of B)m();document.body.removeEventListener("keypress",$),document.body.removeEventListener("keyup",N)});const[H,E]=Z([]);window.setPrompt=(m,v,w,P)=>{const C=Math.random(),O=()=>{E(H().filter(T=>T.id!==C))};E([...H(),{callback:T=>(w(T),O(),setTimeout(()=>{app.graph.setDirtyCanvas(!0,!0)}),!0),exit:()=>{O()},position:{x:v[0],y:v[1]},title:m,id:C,fallback:P}])};const R=oe(()=>Object.values(M()).filter(Boolean).length>0),V=oe(()=>Object.values(n).sort(qi(n))),U=()=>{const m=window.open("","_blank","width=1280,height=720,location=no,toolbar=no,menubar=no");if(m.document.write(`
		<!DOCTYPE html>
		<html lang="en">
			<head>
				<meta charset="UTF-8" />
				<title>mape's Helpers - Image Preview</title>
			</head>
			<body>
				<script>
					window.standaloneImagePreview = true;
					import('/extensions/ComfyUI-mape-Helpers/tweak/mape-helpers.js');
				<\/script>
			</body>
		</html>
		`),m){let v=!0;m.addEventListener("unload",()=>{if(v){v=!1;return}e([...t().filter(w=>w!==m)])}),e([...t(),m])}else console.error("Failed to open a new window.")};return window.showWarnings=(m=!0)=>{d(m)},(()=>{var m=kl(),v=m.firstChild,w=v.firstChild,P=w.nextSibling,C=P.nextSibling,O=C.firstChild,T=O.nextSibling,L=T.nextSibling,k=v.nextSibling;return w.$$click=y,K(P,fe(Fi,{get each(){return V()},children:(W,z)=>(()=>{var G=xl();return K(G,(()=>{var D=oe(()=>!!(A[W.type]&&typeof W.value<"u"));return()=>D()?A[W.type](W):A.DEFAULT(W)})()),X(D=>{var J=!!M()[z()+1],Q=!!R();return J!==D.e&&G.classList.toggle("active",D.e=J),Q!==D.t&&G.classList.toggle("siblingActive",D.t=Q),D},{e:void 0,t:void 0}),G})()})),K(C,(()=>{var W=oe(()=>r().length>0);return()=>W()?(()=>{var z=Sl();return z.$$click=()=>{d(!p())},z})():null})(),O),O.$$click=()=>{U()},T.$$click=()=>{if(confirm("Clear all favourites?")){for(const W of Object.keys(localStorage))if(W.startsWith(Ht)){const z=W.replace(Ht,"");for(const G of ws(z,"set"))be(G,!1,1);delete localStorage[W]}y()}},L.$$click=()=>{g(!c()),c()&&u(!1)},k.style.setProperty("--ninja-font-family","Arial"),k.style.setProperty("position","relative"),k.style.setProperty("z-index","23"),K(k,fe(qr,{isDark:!0,get hotkeys(){return b()}})),K(m,()=>H().map(W=>fe(sl,W)),null),K(m,(()=>{var W=oe(()=>!!c());return()=>W()?fe(vs,{close:()=>{g(!1)}}):null})(),null),K(m,(()=>{var W=oe(()=>!!a());return()=>W()?fe(nl,{close:()=>{u(!1)}}):null})(),null),K(m,(()=>{var W=oe(()=>!!p());return()=>W()?fe(al,{get warnings(){return r()},close:()=>{window.mapeErrors=[],d(!1)}}):null})(),null),m})()};Ze(["click","input"]);const El=Object.freeze(Object.defineProperty({__proto__:null,MapeTweak:Al},Symbol.toStringTag,{value:"Module"}));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=mape-helpers.js.map
(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@import"https://fonts.googleapis.com/css?family=Material+Icons&display=block";.settingsPopup{position:fixed;background:#333;top:30px;right:0;color:#fff;font-family:arial;min-width:500px;z-index:1111111111;box-shadow:0 10px 20px #0000004d;border:1px solid #444}.settingsPopup .close{cursor:pointer;position:absolute;top:10px;right:10px;filter:saturate(0)}.settingsPopup .close:hover{transform:scale(1.1);filter:saturate(1)}.settingsPopup .close:active{transform:scale(.9)}.settingsPopup .header{background:#0000004d;border-bottom:1px solid rgba(255,255,255,.1);font-size:20px;padding:10px 15px;text-transform:uppercase}.settingsPopup .modalContent{max-height:calc(100vh - 100px);overflow:auto}.settingsPopup .mapeSetting{display:flex;position:relative;padding:1px 0;margin:0 3px;z-index:1}.settingsPopup .mapeSetting .name{background:#0003;padding:8px 10px;border-radius:5px 0 0 5px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;border-right:0;font-size:11px;color:#fff9;line-height:10px;min-width:400px;line-height:1.5}.settingsPopup .mapeSetting input{padding:5px;height:22px;color:#fff;font-size:11px;width:100%;border:0;background:transparent;resize:none;font-family:monospace}.settingsPopup .mapeSetting input:focus,.settingsPopup .mapeSetting input:active{outline:1px solid transparent}.settingsPopup .mapeSetting input[type=checkbox]{vertical-align:top;min-width:15px;max-width:15px;min-height:15px;max-height:15px;background-color:#0003;display:inline-block;margin-right:.8vh;border-radius:100%;margin-top:.45vh;box-shadow:0 0 0 .1vh #fff3;padding:.5vh;-webkit-appearance:none;outline:none;margin:0 auto;display:block}.settingsPopup .mapeSetting input[type=checkbox]:hover{background-color:#ffffff1a}.settingsPopup .mapeSetting input[type=checkbox]:checked{background:#fff}.settingsPopup .mapeSetting input[type=checkbox]:disabled{opacity:.2}.settingsPopup .mapeSetting input:focus{color:#ffa}.settingsPopup .mapeSetting input[type=color]{margin:-15px 0 -10px;height:36px;position:relative;top:4px}.settingsPopup .mapeSetting .reset{padding:5px;filter:saturate(0)}.settingsPopup .mapeSetting .reset:hover{filter:saturate(1)}.settingsPopup .mapeSetting .value{width:100%;position:relative;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;background:#222;border-radius:0 5px 5px 0;padding:8px 10px}.imagePreviews{background:repeating-radial-gradient(#181818 0,#181818 4px,#1f1f1f 5px,#1f1f1f 5px);font-family:arial;color:#fff;position:fixed;top:0;left:0;right:0;bottom:0;z-index:1000;margin:0;background-size:10px 10px;display:flex;flex-direction:column}.imagePreviews .content{display:flex;height:100%}.imagePreviews .image{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%}.imagePreviews .imagePreviewTweaks{display:flex;background:#111;padding:10px;justify-content:space-around;border-bottom:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px inset #00000080;gap:10px}.imagePreviews .imagePreviewTweaks .button{flex:auto;vertical-align:top;border:0;text-transform:uppercase;text-shadow:2px 2px 1px #000000;-webkit-user-select:none;user-select:none;position:relative;display:inline-block;color:#fff;border-top:1px solid #0f0f12;background:#0f0f0f;margin:2px;border-radius:4px;cursor:pointer;line-height:1;transition:color 1s;outline:none;text-align:center;opacity:.5;padding:8px 10px}.imagePreviews .imagePreviewTweaks .button.active{background:#490000}.imagePreviews .imagePreviewTweaks .button:before{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:4px;background:linear-gradient(to bottom,#ffffff17,#ffffff0a);box-shadow:inset 0 1px #ffffff0d,inset 0 0 1px #fff3;content:"";pointer-events:none}.imagePreviews .imagePreviewTweaks .button:hover:before{background:linear-gradient(to bottom,#ffffff1f,#ffffff0f)}.imagePreviews .imagePreviewTweaks .button:active:before{box-shadow:inset 0 1px 3px #0000004d;background:linear-gradient(to bottom,#ffffff0f,#fff0)}.imagePreviews .imagePreviewTweaks .button:active{transform:translate(1px,1px)}.imagePreviews .imagePreviewTweaks .button.active{opacity:1}.imagePreviews .imagePreviewTweaks label{text-transform:uppercase;padding:8px 10px;color:#ffffff80;line-height:21px}.imagePreviews .value{width:50px}.imagePreviews .value{position:static}.imagePreviews .bigPreview{width:100%;height:100%;overflow:hidden;position:relative;cursor:move}.imagePreviews .fullImage{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);max-width:98%;max-height:calc(100vh - 80px);border:1px solid rgba(255,255,255,.2);box-shadow:0 0 60px #0000004d,0 0 30px #0000004d;transform-origin:top left}.imagePreviews .thumbnails{display:flex;left:0;right:0;bottom:0;background:#111;padding:10px;justify-content:flex-start;border-bottom:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px inset #00000080;flex-direction:column;max-width:100px;gap:10px;width:100px}.imagePreviews .thumbnails .thumb{width:100%;opacity:.2;cursor:pointer;position:relative;height:100%}.imagePreviews .thumbnails .thumb:hover{opacity:.7}.imagePreviews .thumbnails .thumb.active{opacity:1}.imagePreviews .thumbnails .thumb img{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);border-radius:10px}.imagePreviews .thumbnails .smallImage{border-radius:5px;max-width:100%;max-height:100%;margin:0 auto;display:block}.imagePreviews .mosaicGrid{width:100%;height:100%;position:absolute;top:50%;left:50%;transform-origin:top left}.imagePreviews .mosaicGrid .inner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;display:flex;flex-direction:row;align-content:center;flex-wrap:wrap;justify-content:center}.imagePreviews .mosaicGrid .mosaicImage{display:inline-block;transform:none;box-shadow:0 0 60px #0000004d,0 0 30px #0000004d}.imagePreviews .mosaicGrid .mosaicImage img{width:100%;height:100%}.imagePreviews .zoom{font-size:20px;font-weight:700;position:absolute;top:16px;right:15px;text-shadow:2px 2px 4px rgba(0,0,0,.7);cursor:pointer!important;cursor:pointer}.imagePreviews .zoom:hover{transform:scale(1.1);filter:saturate(1)}.imagePreviews .zoom:active{transform:scale(.9)}.imagePreviews .flipbookFps{font-size:20px;font-weight:700;position:absolute;top:15px;right:100px;text-shadow:2px 2px 4px rgba(0,0,0,.7);cursor:pointer!important}.imagePreviews .flipbookFps label{margin-right:10px}.imagePreviews .flipbookFps input{background:transparent;color:#fff;border:0;background:#0003;padding:5px 3px;border-radius:5px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;border-right:0;font-size:11px;color:#fff9;line-height:10px;width:40px;position:relative;font-size:16px;top:-1px;margin-right:20px}.imagePreviews .flipbookFps input[type=checkbox]{vertical-align:top;min-width:15px;max-width:15px;min-height:15px;max-height:15px;background-color:#0003;display:inline-block;margin-right:.8vh;border-radius:100%;margin-top:.45vh;box-shadow:0 0 0 .1vh #fff3;padding:.5vh;-webkit-appearance:none;outline:none;position:relative;top:3px}.imagePreviews .flipbookFps input[type=checkbox]:hover{background-color:#ffffff1a}.imagePreviews .flipbookFps input[type=checkbox]:checked{background:#fff}.imagePreviews .flipbookFps input[type=checkbox]:disabled{opacity:.2}.mapeBar .tweaks .promptTweaker{background:#333;padding:5px 0 10px;border-radius:0 0 5px 5px;position:relative;top:-5px}.mapeBar .tweaks .promptTweaker *{box-sizing:border-box}.mapeBar .tweaks .promptTweaker .promptTweakerPrompts{max-height:calc(100vh - 310px);overflow:auto}.mapeBar .tweaks .promptTweaker .buttons{display:flex;padding:0 10px 10px}.mapeBar .tweaks .promptTweaker button{flex:auto;vertical-align:top;border:0;text-transform:uppercase;text-shadow:2px 2px 1px #000000;-webkit-user-select:none;user-select:none;position:relative;display:inline-block;color:#fff;border-top:1px solid #0f0f12;background:#0f0f0f;margin:2px;border-radius:4px;cursor:pointer;line-height:1;transition:color 1s;outline:none;white-space:nowrap;font-size:11px;height:23px;padding:5px 8px}.mapeBar .tweaks .promptTweaker button.active{background:#490000}.mapeBar .tweaks .promptTweaker button:before{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:4px;background:linear-gradient(to bottom,#ffffff17,#ffffff0a);box-shadow:inset 0 1px #ffffff0d,inset 0 0 1px #fff3;content:"";pointer-events:none}.mapeBar .tweaks .promptTweaker button:hover:before{background:linear-gradient(to bottom,#ffffff1f,#ffffff0f)}.mapeBar .tweaks .promptTweaker button:active:before{box-shadow:inset 0 1px 3px #0000004d;background:linear-gradient(to bottom,#ffffff0f,#fff0)}.mapeBar .tweaks .promptTweaker button:active{transform:translate(1px,1px)}.mapeBar .tweaks .promptTweaker button.remove{width:25px;padding:5px 8px}.mapeBar .tweaks .promptTweaker .prompt{display:flex;padding:0 5px}.mapeBar .tweaks .promptTweaker .prompt label{max-width:130px;min-width:130px;height:auto;line-height:1.5;padding:2px;border-radius:5px}.mapeBar .tweaks .promptTweaker .prompt .weight{padding:0 10px;line-height:26px;min-width:43px;max-width:43px}.mapeBar .tweaks .promptTweaker .prompt input[type=range]{-moz-appearance:none;appearance:none;-webkit-appearance:none}.mapeBar .tweaks .promptTweaker .prompt input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;height:10px;width:10px;border-radius:50%;background:#fff;margin-top:-3px;box-shadow:1px 1px 2px #00000080;cursor:pointer}.mapeBar .tweaks .promptTweaker .prompt input[type=range]::-webkit-slider-runnable-track{width:60%;height:5px;background:#fff3;border-radius:3rem;transition:all .5s;cursor:pointer}.mapeBar .tweaks .promptTweaker .prompt input[type=range]:hover::-webkit-slider-runnable-track{background:#ffffff4d}.mapeBar .tweaks .promptTweaker .prompt.tmp{opacity:.5}.mapeBar .tweaks .promptTweaker .prompt input[type=checkbox]{vertical-align:top;min-width:15px;max-width:15px;min-height:15px;max-height:15px;background-color:#0003;display:inline-block;margin-right:.8vh;border-radius:100%;margin-top:.45vh;box-shadow:0 0 0 .1vh #fff3;padding:.5vh;-webkit-appearance:none;outline:none}.mapeBar .tweaks .promptTweaker .prompt input[type=checkbox]:hover{background-color:#ffffff1a}.mapeBar .tweaks .promptTweaker .prompt input[type=checkbox]:checked{background:#fff}.mapeBar .tweaks .promptTweaker .prompt input[type=checkbox]:disabled{opacity:.2}.mapeBar .tweaks .promptTweaker .prompt .arrows{padding:3px 5px 3px 0;position:relative;top:0}.mapeBar .tweaks .promptTweaker .prompt .arrows .arrow{color:#fff3;font-size:12px;line-height:10px}.mapeBar .tweaks .promptTweaker .prompt .arrows .arrow.disabled{pointer-events:none;opacity:0}.mapeBar .tweaks .promptTweaker .prompt .arrows .arrow:hover{cursor:pointer;color:#ffffffe6}.helpPopup{position:fixed;background:#333;top:30px;right:0;color:#fff;font-family:arial;min-width:500px;z-index:1111111111;box-shadow:0 10px 20px #0000004d;border:1px solid #444}.helpPopup .close{cursor:pointer;position:absolute;top:10px;right:10px;filter:saturate(0)}.helpPopup .close:hover{transform:scale(1.1);filter:saturate(1)}.helpPopup .close:active{transform:scale(.9)}.helpPopup .header{background:#0000004d;border-bottom:1px solid rgba(255,255,255,.1);font-size:20px;padding:10px 15px;text-transform:uppercase}.helpPopup .modalContent{max-height:calc(100vh - 100px);overflow:auto}.helpPopup .modalContent{display:flex}.helpPopup .modalContent .help{padding:15px}.helpPopup .modalContent .help .video,.helpPopup .modalContent .help .image{width:720px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 20px #0009;background:#000c}.helpPopup .modalContent .help .info{border:1px solid rgba(255,255,255,.1);background:#0000001a;margin:10px 0;border-radius:10px;overflow:hidden}.helpPopup .modalContent .help .title{font-size:25px;padding:15px 20px;font-weight:700;text-transform:uppercase;background:#0003;border-bottom:1px solid rgba(255,255,255,.1)}.helpPopup .modalContent .help .text{max-width:720px;font-size:15px;line-height:1.5;padding:15px 20px;font-size:17px;color:#fffc}.helpPopup .modalContent .menu{background-color:#222;margin:0;padding:0}.helpPopup .modalContent .menu li{background:linear-gradient(to right,#0000001a,#0000 20%,#0000);border-left:1px solid #555;padding:10px 15px;list-style:none;color:#ffffff80;border-bottom:1px solid rgba(0,0,0,.2)}.helpPopup .modalContent .menu li:nth-child(odd){background:linear-gradient(to right,#0003,#0000001a 20%,#0000001a);border-bottom:1px solid rgba(0,0,0,.1)}.helpPopup .modalContent .menu li:hover{color:#fff;cursor:pointer}.helpPopup .modalContent .menu li.active{background:#333;color:#fff;box-shadow:6px 2px 6px #0003;border-left:1px solid transparent;border-top:1px solid rgba(255,255,255,.1);border-bottom:1px solid rgba(0,0,0,.1);background:linear-gradient(to right,#333,#424242 20%,#333)}.helpPopup .modalContent .menu li.active:first-child{border-top:0}.mapeConfirmPrompt{font-family:arial;position:fixed;padding:10px;background:#333;border-bottom:1px solid #444;font-size:13px;z-index:111;border-radius:10px;border:2px solid #555;box-shadow:0 0 20px #0003;transform:translate(-50%,-50%)}.mapeConfirmPrompt *{box-sizing:border-box}.mapeConfirmPrompt .title{white-space:nowrap;text-transform:uppercase;padding:0 0 5px;text-align:center}.mapeConfirmPrompt input{position:relative;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;background:#222;color:#fff;border-radius:5px;padding:8px 10px;width:100%}.mapeConfirmPrompt input:focus,.mapeConfirmPrompt input:active{outline:1px solid transparent}.mapeConfirmPrompt .suggestions{background:#333;border-bottom:1px solid #444;font-size:13px;z-index:111;border:2px solid #555;box-shadow:0 0 20px #0003;position:absolute;top:100%;left:0;right:0;border-radius:5px}.mapeConfirmPrompt .suggestions .suggestion{padding:5px}.mapeConfirmPrompt .suggestions .suggestion:nth-child(odd){background:#0000001a}.mapeConfirmPrompt .suggestions .suggestion:hover,.mapeConfirmPrompt .suggestions .suggestion.selected{color:#ffa;background:#0000004d;cursor:pointer}.warningsPopup{position:fixed;background:#333;top:30px;right:0;color:#fff;font-family:arial;min-width:500px;z-index:1111111111;box-shadow:0 10px 20px #0000004d;border:1px solid #444}.warningsPopup .close{cursor:pointer;position:absolute;top:10px;right:10px;filter:saturate(0)}.warningsPopup .close:hover{transform:scale(1.1);filter:saturate(1)}.warningsPopup .close:active{transform:scale(.9)}.warningsPopup .header{background:#0000004d;border-bottom:1px solid rgba(255,255,255,.1);font-size:20px;padding:10px 15px;text-transform:uppercase}.warningsPopup .modalContent{max-height:calc(100vh - 100px);overflow:auto}.warningsPopup .mapeSetting{display:flex;position:relative;padding:4px 0;margin:0 3px;z-index:1}.warningsPopup .mapeSetting .name{background:#0003;padding:8px 10px;border-radius:5px 0 0 5px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;border-right:0;font-size:11px;color:#fff;line-height:10px;line-height:1.5;width:100%;font-size:16px}.warningsPopup .mapeSetting .name small{padding:0 10px;color:#fff9}.warningsPopup .mapeSetting button{flex:auto;vertical-align:top;border:0;text-transform:uppercase;text-shadow:2px 2px 1px #000000;-webkit-user-select:none;user-select:none;position:relative;display:inline-block;color:#fff;border-top:1px solid #0f0f12;background:#0f0f0f;margin:2px;border-radius:4px;cursor:pointer;line-height:1;transition:color 1s;outline:none;padding:0 10px;white-space:nowrap}.warningsPopup .mapeSetting button.active{background:#490000}.warningsPopup .mapeSetting button:before{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:4px;background:linear-gradient(to bottom,#ffffff17,#ffffff0a);box-shadow:inset 0 1px #ffffff0d,inset 0 0 1px #fff3;content:"";pointer-events:none}.warningsPopup .mapeSetting button:hover:before{background:linear-gradient(to bottom,#ffffff1f,#ffffff0f)}.warningsPopup .mapeSetting button:active:before{box-shadow:inset 0 1px 3px #0000004d;background:linear-gradient(to bottom,#ffffff0f,#fff0)}.warningsPopup .mapeSetting button:active{transform:translate(1px,1px)}@media only screen and (max-height: 850px){html body .comfy-menu{top:30px!important}}.mapeRoot *{box-sizing:border-box;font-family:arial;-webkit-user-select:none;user-select:none}.mapeRoot *::-webkit-scrollbar{width:5px;height:5px;background:linear-gradient(to right,#111,#222)}.mapeRoot *::-webkit-scrollbar-thumb{background:linear-gradient(to bottom,#fff,#aaa);border:1px solid #fff;border-radius:10px}.mapeBar{position:fixed;top:0;left:0;right:0;height:30px;background:#333;border-bottom:1px solid #444;display:flex;font-size:13px;z-index:1111111;border-top:1px solid rgba(255,255,255,.1);background:linear-gradient(to bottom,#353535,#313131 30%,#333)}.mapeBar:after{content:"";display:block;position:absolute;top:100%;left:0;right:0;height:20px;background:linear-gradient(to bottom,#0000002f,#0000);border-top:2px solid rgba(0,0,0,.3);pointer-events:none}.mapeBar .logo{background:url(https://comfyui.ma.pe/logo.svg);background-size:contain;background-repeat:no-repeat;min-width:26px;max-width:26px;margin:8px;cursor:pointer}.mapeBar .logo:hover{transform:scale(1.1);filter:saturate(1)}.mapeBar .logo:active{transform:scale(.9)}.mapeBar .tweakHighlight{position:relative}.mapeBar .tweakHighlight.siblingActive{opacity:.1}.mapeBar .tweakHighlight.active{opacity:1}.mapeBar .tweaks{display:flex}.mapeBar .tweaks .tweak{display:flex;position:relative;padding:4px 0;margin:0 3px;z-index:1}.mapeBar .tweaks .tweak label{background:#0003;padding:5px 8px;height:22px;border-radius:5px 0 0 5px;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;border-right:0;font-size:11px;color:#fff9;line-height:10px}.mapeBar .tweaks .tweak label.interactable{cursor:pointer}.mapeBar .tweaks .tweak label.interactable:hover{color:#fff}.mapeBar .tweaks .tweak.defaultContainer label{border-radius:5px}.mapeBar .tweaks .tweak input,.mapeBar .tweaks .tweak textarea{padding:5px;height:22px;color:#fff;font-size:11px;width:100%;border:0;background:transparent;resize:none;font-family:monospace}.mapeBar .tweaks .tweak input:focus,.mapeBar .tweaks .tweak textarea:focus,.mapeBar .tweaks .tweak input:active,.mapeBar .tweaks .tweak textarea:active{outline:1px solid transparent}.mapeBar .tweaks .tweak input:focus{color:#ffa}.mapeBar .tweaks .tweak .image{position:absolute;top:0;left:0;width:50px;height:50px;border-radius:5px;background:#000;background-size:contain;background-repeat:no-repeat;background-position:center center}.mapeBar .tweaks .tweak .value{width:70px;position:relative;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;background:#222;height:22px;border-radius:0 5px 5px 0}.mapeBar .tweaks .tweak.stringContainer.focused .value{width:450px}.mapeBar .tweaks .tweak.stringContainer.focused textarea{height:150px;padding:10px;line-height:1.5;border:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px #0000004d inset;background:#222}.mapeBar .tweaks .tweak.imageContainer{cursor:pointer}.mapeBar .tweaks .tweak.imageContainer .value{width:50px}.mapeBar .tweaks .tweak.imageContainer .missingImage{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#ffffff80;width:50px;text-align:center}.mapeBar .tweaks .tweak.imageContainer .missing{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:20px}.mapeBar .tweaks .tweak.imageContainer.focused{display:block;background:repeating-radial-gradient(#181818 0,#181818 4px,#1f1f1f 5px,#1f1f1f 5px);position:fixed;top:0;left:0;right:0;bottom:0;z-index:1000;margin:0;background-size:10px 10px}.mapeBar .tweaks .tweak.imageContainer.focused label{display:none}.mapeBar .tweaks .tweak.imageContainer.focused .value{position:static}.mapeBar .tweaks .tweak.imageContainer.focused .image{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%}.mapeBar .tweaks .tweak.imageContainer.focused.hasMultiple{top:150px}.mapeBar .tweaks .tweak.imageContainer .fullImage{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);max-width:98%;max-height:98%;border:1px solid rgba(255,255,255,.2);box-shadow:0 0 60px #0000004d,0 0 30px #0000004d}.mapeBar .tweaks .tweak.imageContainer .thumbnails{display:flex;position:absolute;height:150px;left:0;right:0;bottom:100%;background:#111;padding:10px;justify-content:space-around;border-bottom:1px solid rgba(255,255,255,.1);box-shadow:0 0 10px inset #00000080}.mapeBar .tweaks .tweak.imageContainer .thumbnails .thumb{width:100%}.mapeBar .tweaks .tweak.imageContainer .thumbnails .smallImage{border-radius:5px;max-width:100%;max-height:100%;margin:0 auto;display:block}.mapeBar button{width:100px}.mapeBar .options{position:absolute;top:0;font-weight:900;color:#fff;line-height:28px;font-size:18px;background:linear-gradient(to bottom,#353535,#313131 30%,#333);display:flex;right:5px;height:29px;gap:5px;padding:0 5px;z-index:9}.mapeBar .options div{filter:saturate(.8);cursor:pointer}.mapeBar .options div:hover{transform:scale(1.1);filter:saturate(1)}.mapeBar .options div:active{transform:scale(.9)}.mapeBar .options div small{position:absolute;top:6px;left:12px;font-size:62%}@keyframes fadeInOut{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}.mapeBar .options .blink{animation:fadeInOut 1s ease-in-out infinite}')),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
